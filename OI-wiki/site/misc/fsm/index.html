
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta http-equiv="x-dns-prefetch-control" content="on">
      <link rel="dns-prefetch" href="//oi-wiki.org">
      <link rel="dns-prefetch" href="//search.oi-wiki.org">
      <link rel="dns-prefetch" href="//api.github.com">
      <link rel="dns-prefetch" href="//www.google-analytics.com">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛">
      
      
        <meta name="author" content="CCXXXI, countercurrent-time, Enter-tainer, FFjet, H-J-Granger, Ir1d, mgt, NachtgeistW, orzAtalod, ouuan, SukkaW">
      
      
        <link rel="canonical" href="https://oi-wiki.org/misc/fsm/">
      
      
        <link rel="prev" href="../hoverline/">
      
      
        <link rel="next" href="../cc-basic/">
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.6.15">
    
    
      
        <title>有限状态自动机 - OI Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3167ff.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:300;src:url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot');src:local('Fira Sans'),local('FiraSans-Normal'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix') format('embedded-opentype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2') format('woff2'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff') format('woff'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf') format('truetype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans') format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:regular;src:url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot');src:local('Fira Sans'),local('FiraSans-Normal'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix') format('embedded-opentype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2') format('woff2'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff') format('woff'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf') format('truetype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans') format('svg')}@font-face{font-family:'Fira Sans';font-style:italic;font-weight:regular;src:url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot');src:local('Fira Sans'),local('FiraSans-Italic'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix') format('embedded-opentype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2') format('woff2'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff') format('woff'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf') format('truetype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans') format('svg')}@font-face{font-family:'Fira Sans';font-style:normal;font-weight:700;src:url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot');src:local('Fira Sans'),local('FiraSans-Normal'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix') format('embedded-opentype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2') format('woff2'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff') format('woff'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf') format('truetype'),url('//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans') format('svg')}@font-face{font-family:'Fira Mono';font-style:normal;font-weight:regular;src:url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot');src:local('Fira Mono'),local('FiraMono-Normal'),url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix') format('embedded-opentype'),url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2') format('woff2'),url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff') format('woff'),url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf') format('truetype'),url('//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono') format('svg')}</style>
      
    
    
      <link rel="stylesheet" href="../../_static/css/extra.css?v=16">
    
      <link rel="stylesheet" href="../../{OIWikiFeedbackSystemFrontendCSS}">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-124485594-1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-124485594-1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-124485594-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  <script src="../../assets/javascripts/toggle-sidebar.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#自动机入门" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="OI Wiki" class="md-header__button md-logo" aria-label="OI Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OI Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              有限状态自动机
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OI-wiki/OI-wiki" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OI-wiki/OI-wiki
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  简介

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contest/" class="md-tabs__link">
          
  
  
  比赛相关

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tools/" class="md-tabs__link">
          
  
  
  工具软件

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lang/" class="md-tabs__link">
          
  
  
  语言基础

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../basic/" class="md-tabs__link">
          
  
  
  算法基础

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../search/" class="md-tabs__link">
          
  
  
  搜索

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../dp/" class="md-tabs__link">
          
  
  
  动态规划

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../string/" class="md-tabs__link">
          
  
  
  字符串

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../math/" class="md-tabs__link">
          
  
  
  数学

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ds/" class="md-tabs__link">
          
  
  
  数据结构

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../graph/" class="md-tabs__link">
          
  
  
  图论

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../geometry/" class="md-tabs__link">
          
  
  
  计算几何

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  杂项

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topic/rmq/" class="md-tabs__link">
          
  
  
  专题

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OI Wiki" class="md-nav__button md-logo" aria-label="OI Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"/></svg>

    </a>
    OI Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OI-wiki/OI-wiki" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OI-wiki/OI-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    简介
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            简介
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于本项目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/htc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何参与
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/what-oi-wiki-is-not/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OI Wiki 不是什么
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    格式手册
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/symbol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数学符号表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    F.A.Q.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/mirrors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    镜像站列表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/thanks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    致谢
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    比赛相关
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            比赛相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    比赛相关简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    赛事
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            赛事
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/oi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OI 赛事与赛制
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/icpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICPC/CCPC 赛事与赛制
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    题型
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            题型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    题型概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/interaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    交互题
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    学习路线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    学习资源
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    技巧
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            技巧
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    读入、输出优化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/dictionary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分段打表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/common-mistakes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常见错误
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/common-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常见技巧
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contest/problemsetting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    出题
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    工具软件
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            工具软件
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具软件简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    代码编辑工具
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            代码编辑工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/vim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/emacs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emacs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/vscode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VS Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/atom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Atom
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/eclipse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Eclipse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/npp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Notepad++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/kate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/devcpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dev-C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/clion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/geany/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geany
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/xcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Xcode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GUIDE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/sublime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sublime Text
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/cpeditor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CP Editor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/editor/codeblocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code::Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    评测工具
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            评测工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/judger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    评测工具简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/judger/arbiter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arbiter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/judger/cena/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cena
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/judger/ccr-plus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CCR Plus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/judger/lemon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lemon
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    命令行
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/compile-debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    命令行编译与调试
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/compiler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    编译器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/wsl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WSL (Windows 10)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/special-judge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Special Judge
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Testlib
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Testlib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testlib 简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    通用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/validator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/interactor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/testlib/checker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/polygon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Polygon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/oj-tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OJ 工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/latex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LaTeX 入门
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    语言基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            语言基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    语言基础简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++ 基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            C++ 基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/helloworld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello, World!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++ 语法基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/var/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    变量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/op/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    运算
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_5" >
        
          
          <label class="md-nav__link" for="__nav_4_2_5" id="__nav_4_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    流程控制语句
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            流程控制语句
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/branch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分支
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    循环
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_6" >
        
          
          <label class="md-nav__link" for="__nav_4_2_6" id="__nav_4_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    高级数据类型
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_6">
            <span class="md-nav__icon md-icon"></span>
            高级数据类型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/array/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/struct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    结构体
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/union/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    联合体
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/pointer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    指针
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/func/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/file-op/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    文件操作
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++ 标准库
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            C++ 标准库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++ 标准库简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    STL 容器
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            STL 容器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STL 容器简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/iterator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    迭代器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/sequence-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    序列式容器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/associative-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关联式容器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/unordered-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    无序关联式容器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/container-adapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    容器适配器
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STL 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/bitset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bitset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/string/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    string
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/csl/pair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pair
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++ 进阶
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            C++ 进阶
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    类
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/namespace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    命名空间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/value-category/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    值类别
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/op-overload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    重载运算符
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    引用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/const/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/new/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    新版 C++ 特性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/lambda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lambda 表达式
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_4_9" id="__nav_4_4_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pb_ds
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_9">
            <span class="md-nav__icon md-icon"></span>
            pb_ds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/pb-ds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pb_ds 简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/pb-ds/pq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    堆
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/pb-ds/tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平衡树
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/optimizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    编译优化
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/cpp-other-langs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++ 与其他常用语言的区别
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/pas-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pascal 转 C++ 急救
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python 速成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java 速成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lang/java-pro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java 进阶
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    算法基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            算法基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    算法基础简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    复杂度
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            复杂度
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/complexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    复杂度简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/amortized-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    均摊复杂度
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/enumerate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    枚举
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/simulate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模拟
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/divide-and-conquer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    递归 & 分治
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/greedy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    贪心
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    排序
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            排序
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/sort-intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排序简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/selection-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    选择排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bubble-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    冒泡排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/insertion-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    插入排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/counting-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计数排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/radix-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基数排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/quick-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/merge-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    归并排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/heap-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    堆排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/bucket-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    桶排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/shell-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    希尔排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/tournament-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    锦标赛排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/tim-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tim 排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/stl-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排序相关 STL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/use-of-sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排序应用
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/prefix-sum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    前缀和 & 差分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/binary-lifting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    倍增
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basic/construction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    构造
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    搜索
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            搜索
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    搜索部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/dfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DFS（搜索）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/bfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BFS（搜索）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/bidirectional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    双向搜索
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/heuristic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    启发式搜索
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/astar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A*
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/iterative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    迭代加深搜索
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/idastar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IDA*
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/backtracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    回溯法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/dlx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dancing Links
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/alpha-beta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alpha–Beta 剪枝
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search/opt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    优化
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    动态规划
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            动态规划
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    动态规划部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    动态规划基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/memo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    记忆化搜索
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/knapsack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    背包 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/interval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    区间 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/dag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DAG 上的 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树形 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状压 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/number/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数位 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/plug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    插头 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/count/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计数 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/dynamic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    动态 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/probability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概率 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/dp-of-dp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DP 套 DP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_15" >
        
          
          <label class="md-nav__link" for="__nav_7_15" id="__nav_7_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DP 优化
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_15">
            <span class="md-nav__icon md-icon"></span>
            DP 优化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/dp-opt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DP 优化简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/monotonous-queue-stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单调队列/单调栈优化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/slope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    斜率优化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/quadrangle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    四边形不等式优化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/slope-trick/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slope Trick 优化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/wqs-binary-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WQS 二分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/opt/state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    状态设计优化
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dp/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    其它 DP 方法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    字符串
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            字符串
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字符串部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字符串基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/lib-func/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    标准库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字符串匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字符串哈希
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/trie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字典树 (Trie)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/kmp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    前缀函数与 KMP 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/bm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boyer–Moore 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/z-func/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Z 函数（扩展 KMP）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/ac-automaton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AC 自动机
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_11" >
        
          
          <label class="md-nav__link" for="__nav_8_11" id="__nav_8_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    后缀数组 (SA)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_11">
            <span class="md-nav__icon md-icon"></span>
            后缀数组 (SA)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/sa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    后缀数组简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/sa-optimal-inplace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最优原地后缀排序算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/sam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    后缀自动机 (SAM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/suffix-bst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    后缀平衡树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/general-sam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    广义后缀自动机
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/suffix-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    后缀树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/manacher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manacher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/pam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    回文树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/seq-automaton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    序列自动机
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/minimal-string/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小表示法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/lyndon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lyndon 分解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../string/main-lorentz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main–Lorentz 算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数学部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/boolean-algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    布尔代数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数字系统
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            数字系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numeral-sys/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数字系统简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numeral-sys/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    进位制
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numeral-sys/balanced-ternary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平衡三进制
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numeral-sys/gray-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    格雷码
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    位操作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/binary-set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二进制集合操作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/bignum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高精度计算
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/binary-exponentiation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速幂
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/permutation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    置换和排列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/coordinate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    弧度制与坐标系
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    复数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_11" >
        
          
          <label class="md-nav__link" for="__nav_9_11" id="__nav_9_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_11">
            <span class="md-nav__icon md-icon"></span>
            数论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数论基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/mod-arithmetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模算术简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/prime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    素数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/gcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最大公约数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/euler-totient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    欧拉函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/sieve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    筛法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/pollard-rho/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分解质因数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/bezouts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    裴蜀定理 & 一次不定方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/fermat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    费马小定理 & 欧拉定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模逆元
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/linear-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性同余方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/crt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    中国剩余定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/lift-the-exponent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    升幂引理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/factorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    阶乘取模
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/lucas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    卢卡斯定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/congruence-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    同余方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/quad-residue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二次剩余
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/primitive-root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    阶 & 原根
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/discrete-logarithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离散对数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/residue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高次剩余 & 单位根
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/sqrt-decomposition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数论分块
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/dirichlet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    狄利克雷卷积
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/mobius/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    莫比乌斯反演
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/du/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    杜教筛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/powerful-number/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Powerful Number 筛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/min-25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Min_25 筛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/zhou/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    洲阁筛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/euclidean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    类欧几里德算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/meissel-lehmer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Meissel–Lehmer 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/continued-fraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    连分数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/stern-brocot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stern–Brocot 树与 Farey 序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/quadratic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二次域
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/number-theory/pell-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pell 方程
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_12" >
        
          
          <label class="md-nav__link" for="__nav_9_12" id="__nav_9_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    多项式与生成函数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_12">
            <span class="md-nav__icon md-icon"></span>
            多项式与生成函数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多项式与生成函数简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/fundamental/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    代数基本定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/fft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速傅里叶变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/ntt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速数论变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/fwt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速沃尔什变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/czt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chirp Z 变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/newton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多项式牛顿迭代
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/multipoint-eval-interpolation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多项式多点求值|快速插值
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/elementary-func/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多项式初等函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/linear-recurrence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常系数齐次线性递推
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/shift/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多项式平移|连续点值平移
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/symbolic-method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    符号化方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/lagrange-inversion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lagrange 反演
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/comp-rev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    形式幂级数复合|复合逆
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/ogf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    普通生成函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/poly/egf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    指数生成函数
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_13" >
        
          
          <label class="md-nav__link" for="__nav_9_13" id="__nav_9_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    组合数学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_13">
            <span class="md-nav__icon md-icon"></span>
            组合数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/combination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    排列组合
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/drawer-principle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    抽屉原理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/inclusion-exclusion-principle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    容斥原理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/fibonacci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    斐波那契数列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/derangement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    错位排列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/catalan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    卡特兰数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/stirling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    斯特林数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/bell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    贝尔数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/bernoulli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    伯努利数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/entringer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entringer Number
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/eulerian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Eulerian Number
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/partition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分拆数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/vandermonde-convolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    范德蒙德卷积
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/polya/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pólya 计数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/combinatorics/graph-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图论计数
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_14" >
        
          
          <label class="md-nav__link" for="__nav_9_14" id="__nav_9_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    线性代数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_14">
            <span class="md-nav__icon md-icon"></span>
            线性代数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/vector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    向量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/product/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    内积和外积
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/elementary-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    初等变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/determinant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    行列式
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/vector-space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性空间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/basis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性基
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/linear-mapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性映射
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/char-poly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    特征多项式
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/diagonalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    对角化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-algebra/jordan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jordan标准型
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_15" >
        
          
          <label class="md-nav__link" for="__nav_9_15" id="__nav_9_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    线性规划
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_15">
            <span class="md-nav__icon md-icon"></span>
            线性规划
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/linear-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性规划基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/simplex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单纯形法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_16" >
        
          
          <label class="md-nav__link" for="__nav_9_16" id="__nav_9_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    抽象代数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_16">
            <span class="md-nav__icon md-icon"></span>
            抽象代数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/algebra/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基本概念
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/algebra/group-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    群论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/algebra/ring-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    环论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/algebra/field-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    域论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/algebra/schreier-sims/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schreier–Sims 算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_17" >
        
          
          <label class="md-nav__link" for="__nav_9_17" id="__nav_9_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    概率论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_17">
            <span class="md-nav__icon md-icon"></span>
            概率论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/probability/basic-conception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基本概念
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/probability/conditional-probability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    条件概率与独立性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/probability/random-variable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    随机变量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/probability/exp-var/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    随机变量的数字特征
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/probability/concentration-inequality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概率不等式
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_18" >
        
          
          <label class="md-nav__link" for="__nav_9_18" id="__nav_9_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    博弈论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_18">
            <span class="md-nav__icon md-icon"></span>
            博弈论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    博弈论简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/impartial-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    公平组合游戏
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/zero-sum-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    零和游戏
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/game-theory/partizan-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    非公平组合游戏
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_19" >
        
          
          <label class="md-nav__link" for="__nav_9_19" id="__nav_9_19_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数值算法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_19">
            <span class="md-nav__icon md-icon"></span>
            数值算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numerical/interp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    插值
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numerical/integral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数值积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numerical/gauss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高斯消元
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/numerical/newton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    牛顿迭代法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/order-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    序理论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/young-tableau/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    杨氏矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/matroid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    拟阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/berlekamp-massey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Berlekamp–Massey 算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据结构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据结构部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    栈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    队列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/linked-list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    链表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    哈希表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    并查集
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            并查集
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/dsu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并查集
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/dsu-complexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并查集复杂度
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    堆
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            堆
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    堆简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/binary-heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二叉堆
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/pairing-heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    配对堆
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/leftist-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    左偏树
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_8" >
        
          
          <label class="md-nav__link" for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    块状数据结构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            块状数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/decompose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分块思想
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/block-array/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    块状数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/block-list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    块状链表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/tree-decompose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树分块
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/sqrt-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sqrt Tree
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/monotonous-stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单调栈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/monotonous-queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单调队列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/sparse-table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ST 表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/fenwick/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树状数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_13" >
        
          
          <label class="md-nav__link" for="__nav_10_13" id="__nav_10_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    线段树
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_13">
            <span class="md-nav__icon md-icon"></span>
            线段树
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线段树基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg-merge-split/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线段树合并 & 分裂
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/li-chao-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    李超线段树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/cat-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    猫树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg-beats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    区间最值操作 & 区间历史最值
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/kinetic-tournament-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kinetic Tournament Tree
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/dividing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    划分树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_15" >
        
          
          <label class="md-nav__link" for="__nav_10_15" id="__nav_10_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    二叉搜索树 & 平衡树
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_15">
            <span class="md-nav__icon md-icon"></span>
            二叉搜索树 & 平衡树
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/bst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二叉搜索树 & 平衡树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/treap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Treap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/splay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splay 树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/wblt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WBLT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/sgt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    替罪羊树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/cartesian-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    笛卡尔树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/sbt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Size Balanced Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/avl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AVL 树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/rbtree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    红黑树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/llrbt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    左偏红黑树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/aa-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AA 树
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/skiplist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    跳表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_17" >
        
          
          <label class="md-nav__link" for="__nav_10_17" id="__nav_10_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    可持久化数据结构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_17">
            <span class="md-nav__icon md-icon"></span>
            可持久化数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化数据结构简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent-seg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化线段树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent-block-array/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化块状数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent-balanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化平衡树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent-trie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化字典树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/persistent-heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    可持久化可并堆
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_18" >
        
          
          <label class="md-nav__link" for="__nav_10_18" id="__nav_10_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    树套树
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_18">
            <span class="md-nav__icon md-icon"></span>
            树套树
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg-in-seg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线段树套线段树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg-in-balanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平衡树套线段树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/balanced-in-seg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线段树套平衡树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/seg-in-bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树状数组套权值线段树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/bit-in-block-array/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分块套树状数组
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/kdt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K-D Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_20" >
        
          
          <label class="md-nav__link" for="__nav_10_20" id="__nav_10_20_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    动态树
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_20">
            <span class="md-nav__icon md-icon"></span>
            动态树
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/lct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Link Cut Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/global-bst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    全局平衡二叉树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/ett/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Euler Tour Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/top-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Top Tree
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/divide-combine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    析合树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/pq-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PQ 树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/finger-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    手指树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ds/huffman-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    霍夫曼树
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    图论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            图论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图论部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图论相关概念
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/save/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图的存储
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DFS（图论）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/bfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BFS（图论）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_6" >
        
          
          <label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    树上问题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_6">
            <span class="md-nav__icon md-icon"></span>
            树上问题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-diameter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树的直径
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-center/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树的中心
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-centroid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树的重心
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/lca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最近公共祖先
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/hld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树链剖分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dsu-on-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树上启发式合并
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/virtual-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    虚树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-divide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树分治
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dynamic-tree-divide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    动态树分治
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-ahu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AHU 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树哈希
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/tree-random-walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树上随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    有向无环图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/topo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    拓扑排序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_9" >
        
          
          <label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    最短路问题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_9">
            <span class="md-nav__icon md-icon"></span>
            最短路问题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/shortest-path/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最短路
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/diff-constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    差分约束
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/kth-path/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    k 短路
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/mod-shortest-path/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    同余最短路
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_10" >
        
          
          <label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    生成树问题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_10">
            <span class="md-nav__icon md-icon"></span>
            生成树问题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/mst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小生成树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dmst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小树形图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/mdst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小直径生成树
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/steiner-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    斯坦纳树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    拆点
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_13" >
        
          
          <label class="md-nav__link" for="__nav_11_13" id="__nav_11_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    连通性相关
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_13">
            <span class="md-nav__icon md-icon"></span>
            连通性相关
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/scc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    强连通分量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/bcc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    双连通分量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/cut/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    割点和桥
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/block-forest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    圆方树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/connectivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    点/边连通度
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/rings-count/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    环计数问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/min-cycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小环
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/2-sat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2-SAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/euler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    欧拉图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/hamilton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    哈密顿图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/bi-graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/planar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平面图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/chord/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    弦图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/color/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图的着色
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_23" >
        
          
          <label class="md-nav__link" for="__nav_11_23" id="__nav_11_23_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    网络流
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_23">
            <span class="md-nav__icon md-icon"></span>
            网络流
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络流简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/flow/max-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最大流
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/flow/min-cut/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小割
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/flow/min-cost/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    费用流
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/flow/bound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    上下界网络流
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/stoer-wagner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stoer–Wagner 算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_24" >
        
          
          <label class="md-nav__link" for="__nav_11_24" id="__nav_11_24_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    图的匹配
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_24_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_24">
            <span class="md-nav__icon md-icon"></span>
            图的匹配
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/graph-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/bigraph-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分图最大匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/bigraph-weight-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分图最大权匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/general-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一般图最大匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/general-weight-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    一般图最大权匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-matching/stable-match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    稳定匹配
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/prufer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prüfer 序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/matrix-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    矩阵树定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/lgv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LGV 引理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/max-clique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最大团搜索算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/dominator-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    支配树
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph-random-walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    图上随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算几何
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            计算几何
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算几何部分简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/2d/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二维计算几何基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/3d/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    三维计算几何基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/distance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    距离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/pick/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pick 定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/triangulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    三角剖分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/convex-hull/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    凸包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/scanning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    扫描线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/rotating-calipers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    旋转卡壳
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/half-plane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    半平面交
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/nearest-points/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    平面最近点对
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/random-incremental/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    随机增量法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    反演变换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算几何杂项
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked>
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    杂项
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            杂项
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    杂项简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discrete/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离散化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../two-pointer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    双指针
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4" >
        
          
          <label class="md-nav__link" for="__nav_13_4" id="__nav_13_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    离线算法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4">
            <span class="md-nav__icon md-icon"></span>
            离线算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../offline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    离线算法简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cdq-divide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CDQ 分治
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parallel-binsearch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    整体二分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_4" >
        
          
          <label class="md-nav__link" for="__nav_13_4_4" id="__nav_13_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    莫队算法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4_4">
            <span class="md-nav__icon md-icon"></span>
            莫队算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo-intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    莫队算法简介
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    普通莫队算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modifiable-mo-algo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    带修改莫队
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo-on-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    树上莫队
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rollback-mo-algo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    回滚莫队
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo-2dimen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二维莫队
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo-secondary-offline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    莫队二次离线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mo-algo-with-bitset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    莫队配合 bitset
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frac-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分数规划
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_6" >
        
          
          <label class="md-nav__link" for="__nav_13_6" id="__nav_13_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    随机化
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_6">
            <span class="md-nav__icon md-icon"></span>
            随机化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../random/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    随机函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rand-technique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    随机化技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hill-climbing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    爬山算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulated-annealing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模拟退火
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hoverline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    悬线法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    有限状态自动机
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    有限状态自动机
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#自动机入门" class="md-nav__link">
    <span class="md-ellipsis">
      自动机入门
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#确定性有限状态自动机" class="md-nav__link">
    <span class="md-ellipsis">
      确定性有限状态自动机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#非确定性有限状态自动机" class="md-nav__link">
    <span class="md-ellipsis">
      非确定性有限状态自动机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfa-与-nfa-的等价性" class="md-nav__link">
    <span class="md-ellipsis">
      DFA 与 NFA 的等价性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#计算-dfa-与-nfa-的时间复杂度" class="md-nav__link">
    <span class="md-ellipsis">
      计算 DFA 与 NFA 的时间复杂度
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#正则表达式与正则语言" class="md-nav__link">
    <span class="md-ellipsis">
      正则表达式与正则语言
    </span>
  </a>
  
    <nav class="md-nav" aria-label="正则表达式与正则语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#正则表达式" class="md-nav__link">
    <span class="md-ellipsis">
      正则表达式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#正则语言" class="md-nav__link">
    <span class="md-ellipsis">
      正则语言
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#myhillnerode-定理" class="md-nav__link">
    <span class="md-ellipsis">
      Myhill–Nerode 定理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Myhill–Nerode 定理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#例题" class="md-nav__link">
    <span class="md-ellipsis">
      例题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#习题" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfa-最小化" class="md-nav__link">
    <span class="md-ellipsis">
      DFA 最小化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DFA 最小化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#例题_1" class="md-nav__link">
    <span class="md-ellipsis">
      例题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#习题_1" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#自动机常见应用" class="md-nav__link">
    <span class="md-ellipsis">
      自动机常见应用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="自动机常见应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#字典树" class="md-nav__link">
    <span class="md-ellipsis">
      字典树
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmp-自动机" class="md-nav__link">
    <span class="md-ellipsis">
      KMP 自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ac-自动机" class="md-nav__link">
    <span class="md-ellipsis">
      AC 自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#后缀自动机" class="md-nav__link">
    <span class="md-ellipsis">
      后缀自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#广义后缀自动机" class="md-nav__link">
    <span class="md-ellipsis">
      广义后缀自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#回文自动机" class="md-nav__link">
    <span class="md-ellipsis">
      回文自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#序列自动机" class="md-nav__link">
    <span class="md-ellipsis">
      序列自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dp-套-dp" class="md-nav__link">
    <span class="md-ellipsis">
      DP 套 DP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#后缀链接" class="md-nav__link">
    <span class="md-ellipsis">
      后缀链接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#拓展阅读" class="md-nav__link">
    <span class="md-ellipsis">
      拓展阅读
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cc-basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算理论基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../endianness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字节顺序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../josephus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    约瑟夫问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    表达式求值
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../job-order/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    在一台机器上规划任务
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../main-element/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    主元素问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../garsia-wachs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Garsia–Wachs 算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-puzzle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15-puzzle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kahan-summation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kahan 求和
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../odt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    珂朵莉树/颜色段均摊
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../space-optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    空间优化简介
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    专题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topic/rmq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RMQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topic/dsu-app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并查集应用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topic/bracket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    括号序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topic/segment-tree-offline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线段树与离线询问
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#自动机入门" class="md-nav__link">
    <span class="md-ellipsis">
      自动机入门
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#确定性有限状态自动机" class="md-nav__link">
    <span class="md-ellipsis">
      确定性有限状态自动机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#非确定性有限状态自动机" class="md-nav__link">
    <span class="md-ellipsis">
      非确定性有限状态自动机
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfa-与-nfa-的等价性" class="md-nav__link">
    <span class="md-ellipsis">
      DFA 与 NFA 的等价性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#计算-dfa-与-nfa-的时间复杂度" class="md-nav__link">
    <span class="md-ellipsis">
      计算 DFA 与 NFA 的时间复杂度
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#正则表达式与正则语言" class="md-nav__link">
    <span class="md-ellipsis">
      正则表达式与正则语言
    </span>
  </a>
  
    <nav class="md-nav" aria-label="正则表达式与正则语言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#正则表达式" class="md-nav__link">
    <span class="md-ellipsis">
      正则表达式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#正则语言" class="md-nav__link">
    <span class="md-ellipsis">
      正则语言
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#myhillnerode-定理" class="md-nav__link">
    <span class="md-ellipsis">
      Myhill–Nerode 定理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Myhill–Nerode 定理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#例题" class="md-nav__link">
    <span class="md-ellipsis">
      例题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#习题" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfa-最小化" class="md-nav__link">
    <span class="md-ellipsis">
      DFA 最小化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DFA 最小化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#例题_1" class="md-nav__link">
    <span class="md-ellipsis">
      例题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#习题_1" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#自动机常见应用" class="md-nav__link">
    <span class="md-ellipsis">
      自动机常见应用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="自动机常见应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#字典树" class="md-nav__link">
    <span class="md-ellipsis">
      字典树
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kmp-自动机" class="md-nav__link">
    <span class="md-ellipsis">
      KMP 自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ac-自动机" class="md-nav__link">
    <span class="md-ellipsis">
      AC 自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#后缀自动机" class="md-nav__link">
    <span class="md-ellipsis">
      后缀自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#广义后缀自动机" class="md-nav__link">
    <span class="md-ellipsis">
      广义后缀自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#回文自动机" class="md-nav__link">
    <span class="md-ellipsis">
      回文自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#序列自动机" class="md-nav__link">
    <span class="md-ellipsis">
      序列自动机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dp-套-dp" class="md-nav__link">
    <span class="md-ellipsis">
      DP 套 DP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#后缀链接" class="md-nav__link">
    <span class="md-ellipsis">
      后缀链接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#拓展阅读" class="md-nav__link">
    <span class="md-ellipsis">
      拓展阅读
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://oi-wiki.org/edit-landing/?ref=/misc/fsm.md" title="编辑此页" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  
    <h1>有限状态自动机</h1>
  

<p data-original-document-end="32" data-original-document-start="0">前置知识：<a href="../cc-basic/#问题">语言和判定问题</a></p>
<p data-original-document-end="256" data-original-document-start="34"><strong>有限状态自动机</strong>（Finite State Machine，FSM，以下也简称自动机）是最简单的一类计算模型，体现在它的描述能力与资源都极其有限．自动机广泛应用在 OI、计算机科学中，其思想在许多字符串算法中都有涉及，因此推荐在学习一些字符串算法（<a href="../../string/kmp/">KMP</a>、<a href="../../string/ac-automaton/">AC 自动机</a>、<a href="../../string/sam/">SAM</a>）前先完成自动机的学习．</p>
<h2 data-original-document-end="266" data-original-document-start="258" id="自动机入门">自动机入门<a class="headerlink" href="#自动机入门" title="Permanent link"></a></h2>
<p data-original-document-end="320" data-original-document-start="268">首先，我们来理解自动机是用来做什么的：自动机是一种判断一个信号序列是否满足某种特定模式或规则的数学模型．</p>
<p data-original-document-end="490" data-original-document-start="322">这句话中的一些术语可以具体解释一下．「信号序列」指的是一个按顺序排列的信号，例如字符串从前到后的每一个字符、数组从 <span class="arithmatex">\(1\)</span> 到 <span class="arithmatex">\(n\)</span> 的每一个数、数从高到低的每一位等．「判断是否满足某种规则」，可以理解为：我们关心这个序列是否属于某个特定的集合．这个集合由我们事先设定好的规则来定义，例如「所有长度为偶数的二进制串」或「所有回文串」．</p>
<p data-original-document-end="584" data-original-document-start="492">有时我们需要回答这类问题：一个给定的序列，是否满足某种特性？例如，一个二进制数是否是奇数，一个字符串是否是回文，或是否是另一个字符串的子序列等等．自动机就是用来解决这类问题的数学工具．</p>
<p data-original-document-end="647" data-original-document-start="586">自动机的工作原理和流程图很类似．假设你想要在外卖平台点购一杯奶茶，你的所有选择就构成了一个序列．以下这个流程图是一个例子：</p>
<p data-original-document-end="680" data-original-document-start="649"><img alt="order fsm" src="../images/fsm1.svg" /></p>
<p data-original-document-end="869" data-original-document-start="682">例如，你的选择序列是「打开点单界面 -&gt; 选择奶茶 -&gt; 有奶茶的钱」，那你按顺序经过的状态可能是「外卖平台 -&gt; 点单界面 -&gt; 支付奶茶的钱 -&gt; 买到奶茶」．就这样，我们的这个「奶茶自动机」根据我们的选择，帮我们判定了我们是否买到了奶茶．我们还可以发现，到达一个状态的方法可能不止一条．同样没有买到奶茶，你可能是在点单界面直接退出，或者没有奶茶的钱以至于没有买到奶茶．</p>
<p data-original-document-end="947" data-original-document-start="871">我们通过这个自动机，将信号序列分成了两类：一类是买到了奶茶的信号序列，一类是没有买到奶茶的信号序列．根据最后位于的状态的不同，我们就完成了一个判定问题．</p>
<p data-original-document-end="1092" data-original-document-start="949">虽然我们刚才用流程图来类比自动机的工作过程，但流程图本身只是一个直观的可视化工具，并不构成对自动机的数学定义．为了更准确地刻画自动机的结构，我们需要对流程图中的元素进行抽象．抽象之后，我们发现流程图的结构其实可以简化为一个有向图，其中每个结点表示一种状态，每条有向边表示状态之间的转换．</p>
<p data-original-document-end="1134" data-original-document-start="1094">因此，自动机的核心结构可以形式化地看作是一张有向图，我们称之为 <strong>状态图</strong>．</p>
<p data-original-document-end="1224" data-original-document-start="1136">自动机的工作方式和流程图类似，不同的是：自动机的每一个结点都是一个判定结点；自动机的结点只是一个单纯的状态而非任务；自动机的边可以接受多种字符（不局限于 <code>T</code> 或 <code>F</code>）．</p>
<p data-original-document-end="1255" data-original-document-start="1226">举个例子，完成「判断一个二进制数是不是偶数」的自动机如下：</p>
<p data-original-document-end="1290" data-original-document-start="1257"><img alt="example fsm" src="../images/fsm2.svg" /></p>
<p data-original-document-end="1347" data-original-document-start="1292">从起始结点开始，从高到低接受这个数的二进制序列，然后看最终停在哪里．如果最终停在红圈结点，就是偶数；否则不是．</p>
<p data-original-document-end="1444" data-original-document-start="1349">在这里，我们需要强调，下文中我们会多次提到「字符」、「字符集」之类的名词，这不代表自动机只能应用于字符串领域，字符不一定是 <span class="arithmatex">\(\tt abc\cdots z\)</span> 之类的字母，也可以是一种选择．</p>
<p data-original-document-end="1542" data-original-document-start="1446">如果需要判定一个有限的信号序列和另外一个信号序列的关系（例如另一个信号序列是不是某个信号序列的子序列），那么常用的方法是针对那个有限的信号序列构建一个自动机．这个在学习 KMP 的时候会讲到．</p>
<p data-original-document-end="1622" data-original-document-start="1544">需要注意的是，自动机只是一个 <strong>数学模型</strong>，而 <strong>不是算法</strong>，也 <strong>不是数据结构</strong>．实现同一个自动机的方法有很多种，可能会有不一样的时空复杂度．</p>
<p data-original-document-end="1747" data-original-document-start="1624">接下来你可以选择在本页面继续进一步研究自动机，也可以去学习 <a href="../../string/kmp/">KMP</a>、<a href="../../string/ac-automaton/">AC 自动机</a> 或 <a href="../../string/sam/">SAM</a> 等具体的例子．</p>
<p data-original-document-end="1781" data-original-document-start="1749">FSM 分为两类：确定性有限状态自动机、非确定性有限状态自动机．</p>
<h2 data-original-document-end="1796" data-original-document-start="1783" id="确定性有限状态自动机">确定性有限状态自动机<a class="headerlink" href="#确定性有限状态自动机" title="Permanent link"></a></h2>
<p data-original-document-end="1921" data-original-document-start="1798"><strong>确定性有限状态自动机</strong>（Deterministic Finite Automaton，DFA）体现在它的判定过程是确定性的．以「奶茶自动机」为例子，你只要打开点单界面，就会进入点单界面，不会出现网络崩溃打不开、手机没电黑屏了之类的意外情况．</p>
<details class="abstract" data-original-document-end="2394" data-original-document-start="1923" open="open">
<summary>DFA</summary>
<p>DFA 是一个五元组 <span class="arithmatex">\((Q,\Sigma,\delta,q_0,F)\)</span>，包括：</p>
<ol>
<li><strong>有限状态集合</strong>  <span class="arithmatex">\(Q\)</span>．如果把一个 DFA 看成一张有向图，那么 DFA 中的状态就相当于图上的顶点．</li>
<li><strong>字符集</strong> <span class="arithmatex">\(\Sigma\)</span>．该自动机只能输入这些字符．</li>
<li><strong>转移函数</strong> <span class="arithmatex">\(\delta:Q\times \Sigma \to Q\)</span> 是一个接受两个参数返回一个值的函数，其中第一个参数和返回值都是一个状态，第二个参数是字符集中的一个字符．如果把一个 DFA 看成一张有向图，那么 DFA 中的转移函数就相当于顶点间的边，而每条边上都有一个字符．</li>
<li><strong>起始状态</strong>  <span class="arithmatex">\(q_0\in Q\)</span> 是一个特殊的状态．在不同文章中，起始状态一般用 <span class="arithmatex">\(s\)</span>、<span class="arithmatex">\(\textit{start}\)</span>、<span class="arithmatex">\(q_0\)</span> 表示，本文中选择使用 <span class="arithmatex">\(q_0\)</span> 表示．</li>
<li><strong>接受状态集合</strong>  <span class="arithmatex">\(F\subseteq Q\)</span> 是一组特殊的状态．</li>
</ol>
</details>
<p data-original-document-end="2414" data-original-document-start="2396">DFA 可以简单地用以下结构体表示：</p>
<details class="example" data-original-document-end="2498" data-original-document-start="2416" open="open">
<summary>参考实现</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Deterministic Finite Automaton (DFA)</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">DFA</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w">                                </span><span class="c1">// Alphabet size.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">                                </span><span class="c1">// Number of states.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">q0</span><span class="p">;</span><span class="w">                               </span><span class="c1">// Initial state.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">trans</span><span class="p">;</span><span class="w">  </span><span class="c1">// Transitions: trans[c][q].</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">acc</span><span class="p">;</span><span class="w">                 </span><span class="c1">// Acceptance labels per state:</span>
<span class="w">                                        </span><span class="c1">// - 0 = non-accepting</span>

<span class="w">  </span><span class="n">DFA</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">q0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">q0</span><span class="p">(</span><span class="n">q0</span><span class="p">),</span><span class="w"> </span><span class="n">trans</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span><span class="w"> </span><span class="n">acc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">  </span><span class="c1">// Returns minimized DFA via Hopcroft&#39;s algorithm.</span>
<span class="w">  </span><span class="n">DFA</span><span class="w"> </span><span class="n">hopcroft_minimize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></td></tr></table></div>
</details>
<p data-original-document-end="2545" data-original-document-start="2500">求出输入串 <span class="arithmatex">\(w\)</span> 在 DFA 中的状态序列，并判断它是否被接受的过程称为 <strong>计算</strong>．</p>
<details class="abstract" data-original-document-end="2862" data-original-document-start="2547" open="open">
<summary>DFA 的计算流程</summary>
<p>设 <span class="arithmatex">\(M=(Q,\Sigma,\delta,q_0,F)\)</span> 是一个 DFA，<span class="arithmatex">\(w=w_1w_2\cdots w_n\in\Sigma^*\)</span> 是一个串．若存在 <span class="arithmatex">\(Q\)</span> 中的状态序列 <span class="arithmatex">\(r_0,r_1,\cdots,r_n\)</span> 满足</p>
<ul>
<li><span class="arithmatex">\(r_0=q_0\)</span>，</li>
<li><span class="arithmatex">\(\delta(r_i,w_{i+1})=r_{i+1}\)</span> 对于任何 <span class="arithmatex">\(i=0,1,\cdots,n-1\)</span> 都成立，</li>
<li><span class="arithmatex">\(r_n\in F\)</span>，</li>
</ul>
<p>则称 <span class="arithmatex">\(M\)</span>  <strong>接受</strong>（accepts）<span class="arithmatex">\(w\)</span>．反之，则称 <span class="arithmatex">\(M\)</span>  <strong>不接受</strong>  <span class="arithmatex">\(w\)</span>．</p>
</details>
<p data-original-document-end="2979" data-original-document-start="2864">当一个 DFA 读入一个字符串时，从初始状态起按照转移函数一个一个字符地转移．如果读入完一个字符串的所有字符后位于一个接受状态，那么我们称这个 DFA <strong>接受</strong> 这个字符串，反之我们称这个 DFA <strong>不接受</strong> 这个字符串．</p>
<details class="abstract" data-original-document-end="3080" data-original-document-start="2981" open="open">
<summary>形式语言</summary>
<p>字符集合 <span class="arithmatex">\(\Sigma\)</span> 上的一个 <strong>形式语言</strong>（language），或简称 <strong>语言</strong>，是 <span class="arithmatex">\(\Sigma\)</span> 上字符串的一个集合 <span class="arithmatex">\(L\)</span>．</p>
</details>
<details class="abstract" data-original-document-end="3184" data-original-document-start="3082" open="open">
<summary>自动机识别的语言</summary>
<p>对于一个自动机 <span class="arithmatex">\(M\)</span>，它识别的语言 <span class="arithmatex">\(L(M)\)</span> 就定义为它接受的全部子串的集合 <span class="arithmatex">\(\{w\mid M\text{ accepts }w\}\)</span>．</p>
</details>
<p data-original-document-end="3206" data-original-document-start="3186">并非所有的语言都可以通过 DFA 识别．</p>
<details class="abstract" data-original-document-end="3291" data-original-document-start="3208" open="open">
<summary>正则语言</summary>
<p>如果一个语言能由某个 DFA 识别，则称它为 <strong>正则语言</strong>（regular language），也称为正规语言．</p>
</details>
<p data-original-document-end="3363" data-original-document-start="3293">上文提到过，一个自动机可以由状态图表示出来．如下是一个接受且仅接受字符串 <span class="arithmatex">\(\tt a\)</span>、<span class="arithmatex">\(\tt ab\)</span>、<span class="arithmatex">\(\tt aac\)</span> 的 DFA：</p>
<p data-original-document-end="3387" data-original-document-start="3365"><img alt="" src="../images/fsm3.svg" /></p>
<p data-original-document-end="3417" data-original-document-start="3389">（图中省略了失配状态，所有未画出的转移均指向该失配状态）</p>
<h2 data-original-document-end="3433" data-original-document-start="3419" id="非确定性有限状态自动机">非确定性有限状态自动机<a class="headerlink" href="#非确定性有限状态自动机" title="Permanent link"></a></h2>
<p data-original-document-end="3618" data-original-document-start="3435"><strong>非确定性有限状态自动机</strong><sup id="fnref:nfa-and-nfaepsilon"><a class="footnote-ref" href="#fn:nfa-and-nfaepsilon">1</a></sup>（Nondeterministic Finite Automaton，NFA）是 DFA 的自然推广．在 NFA 中，对于任意状态和任意字符，都可能存在零个、一个或多个后继状态．同时，本节讨论的 NFA 允许接受空字符，也就是说，可以在不消耗任何字符的情况下，由一个状态转移到它的某个后继状态．</p>
<p data-original-document-end="3759" data-original-document-start="3620">举个例子，还是「奶茶自动机」．下单后，尽管有奶茶的钱，却有可能因为网络不佳从而没有买到奶茶，这是存在多个后继；也有可能因为手速慢了，尽管输入的串（即操作序列）是一样的，却因为奶茶售完从而没有买到奶茶，这就是空字符的存在，空字符可走可不走．对前文的自动机稍加修改即可实现上述功能：</p>
<p data-original-document-end="3792" data-original-document-start="3761"><img alt="order nfa" src="../images/fsm4.svg" /></p>
<p data-original-document-end="3895" data-original-document-start="3794">显然，所有的 DFA 都是一个 NFA，所以 NFA 至少可以识别所有正则语言．但是，作为 DFA 的一个扩展，NFA 是否能够识别更多的语言呢？其实不然，我们之后将探讨 DFA 与 NFA 的等价性．</p>
<details class="abstract" data-original-document-end="4355" data-original-document-start="3897" open="open">
<summary>NFA</summary>
<p>令 <span class="arithmatex">\(\mathcal{P}(Q)\)</span> 表示 <span class="arithmatex">\(Q\)</span> 的幂集．令 <span class="arithmatex">\(\varepsilon\notin\Sigma\)</span> 表示空串，并记 <span class="arithmatex">\(\Sigma_\varepsilon = \Sigma\cup\{\varepsilon\}\)</span>．NFA 是一个五元组 <span class="arithmatex">\((Q,\Sigma,\delta,q_0,F)\)</span>，包括：</p>
<ol>
<li><strong>有限状态集合</strong>  <span class="arithmatex">\(Q\)</span>，</li>
<li><strong>字符集</strong> <span class="arithmatex">\(\Sigma\)</span>，</li>
<li><strong>转移函数</strong> <span class="arithmatex">\(\delta:Q\times \Sigma_{\varepsilon} \to \mathcal{P}(Q)\)</span>，一个接受两个参数返回一个 <strong>状态集合</strong> 的函数，其中第一个参数是一个状态，第二个参数是字符集中的一个字符，而返回值则是所有可能的后继状态形成的集合（可能为空），</li>
<li><strong>起始状态</strong>  <span class="arithmatex">\(q_0\in Q\)</span>，</li>
<li><strong>接受状态集合</strong>  <span class="arithmatex">\(F\subseteq Q\)</span>．</li>
</ol>
</details>
<p data-original-document-end="4425" data-original-document-start="4357">NFA 的计算过程，相当于同时运行多个 DFA．每一步操作都穷举所有的可能性，最后，只要有一条分支到达了接受状态，NFA 就接受整个串．</p>
<details class="abstract" data-original-document-end="4754" data-original-document-start="4427" open="open">
<summary>NFA 的计算流程</summary>
<p>设 <span class="arithmatex">\(N=(Q,\Sigma,\delta,q_0,F)\)</span> 是一个 NFA，串 <span class="arithmatex">\(w\)</span> 可以表示为 <span class="arithmatex">\(y_1y_2\cdots y_m\in\Sigma^*_\varepsilon\)</span>．若存在 <span class="arithmatex">\(Q\)</span> 中的状态序列 <span class="arithmatex">\(r_0,r_1,\cdots,r_m\)</span> 满足</p>
<ul>
<li><span class="arithmatex">\(r_0=q_0\)</span>，</li>
<li><span class="arithmatex">\(r_{i+1}\in\delta(r_i,y_{i+1})\)</span> 对于任何 <span class="arithmatex">\(i=0,1,\cdots,m-1\)</span> 都成立，</li>
<li><span class="arithmatex">\(r_m\in F\)</span>，</li>
</ul>
<p>则称 <span class="arithmatex">\(N\)</span>  <strong>接受</strong>  <span class="arithmatex">\(w\)</span>．反之，则称 <span class="arithmatex">\(N\)</span>  <strong>不接受</strong>  <span class="arithmatex">\(w\)</span>．</p>
</details>
<p data-original-document-end="4989" data-original-document-start="4756">由于允许空字符，将串 <span class="arithmatex">\(w\)</span> 表示为 <span class="arithmatex">\(y_1y_2\cdots y_m\in\Sigma^*_\varepsilon\)</span> 时，可以插入任意多的空字符．例如，字符串 <span class="arithmatex">\(\texttt{abc}\)</span> 可以表示为 <span class="arithmatex">\(\texttt{a}\varepsilon\texttt{bc}\varepsilon\varepsilon\in\Sigma^*_\varepsilon\)</span>．相较于 DFA 的每一次输入只对应一个结果，而 NFA 的每次输入可能对应多个结果，形成一个结果集．</p>
<h2 data-original-document-end="5008" data-original-document-start="4991" id="dfa-与-nfa-的等价性">DFA 与 NFA 的等价性<a class="headerlink" href="#dfa-与-nfa-的等价性" title="Permanent link"></a></h2>
<p data-original-document-end="5174" data-original-document-start="5010">我们称两个自动机等价，当且仅当它们能识别的语言相同．DFA 与 NFA 是等价的，即每一个 NFA 都等价于某一个 DFA；因此，NFA 识别的语言类也是全体正则语言．每个 DFA 都可以直接看作一个 NFA；反过来，可以通过 <strong>幂集构造</strong>（powerset construction）的方法将一个 NFA 转换为 DFA．</p>
<details class="abstract" data-original-document-end="5652" data-original-document-start="5176" open="open">
<summary>幂集构造</summary>
<p>假设 NFA 为 <span class="arithmatex">\(N = (Q, \Sigma, \delta, q_0, F)\)</span>．定义 <span class="arithmatex">\(E(q)\)</span> 表示从状态 <span class="arithmatex">\(q\)</span> 出发，只沿 <span class="arithmatex">\(\varepsilon\)</span> 转移能到达的状态集合．</p>
<p>构造 DFA 为 <span class="arithmatex">\(M = (Q', \Sigma, \delta', E(q_0), F')\)</span>，其中：</p>
<ul>
<li><strong>有限状态集合</strong>  <span class="arithmatex">\(Q' = \mathcal{P}(Q)\)</span>，</li>
<li><strong>转移函数</strong> <span class="arithmatex">\(\delta' : Q' \times \Sigma \to Q'\)</span> 满足 <span class="arithmatex">\(\delta'(S, c) = \bigcup_{q \in S,~q' \in \delta(q, c)} E(q')\)</span>，</li>
<li><strong>接受状态集合</strong>  <span class="arithmatex">\(F' = \{ S \subseteq Q \mid S \cap F \neq \varnothing \}\)</span>．</li>
</ul>
<p>显然，计算的每一步中，<span class="arithmatex">\(M\)</span> 所在的状态都对应 <span class="arithmatex">\(N\)</span> 可能处于的状态集合．</p>
</details>
<p data-original-document-end="5813" data-original-document-start="5654">虽然 NFA 与 DFA 识别语言的能力相同，但 NFA 仍然是有用的．这是因为对于某些正则语言，用 NFA 表示所需的状态数远小于 DFA 所需的状态数．例如，可以构造出一个状态数为 <span class="arithmatex">\(n\)</span> 的 NFA 使得它对应的最小 DFA 状态数是 <span class="arithmatex">\(\Theta(2^n)\)</span> 的．此时直接计算 NFA 的时间复杂度是更优的．</p>
<h2 data-original-document-end="5837" data-original-document-start="5815" id="计算-dfa-与-nfa-的时间复杂度">计算 DFA 与 NFA 的时间复杂度<a class="headerlink" href="#计算-dfa-与-nfa-的时间复杂度" title="Permanent link"></a></h2>
<p data-original-document-end="5912" data-original-document-start="5839">设给定的串长为 <span class="arithmatex">\(n\)</span>，自动机状态数为 <span class="arithmatex">\(s\)</span>，字符集大小为常数．那么显然地，DFA 计算的时间复杂度为 <span class="arithmatex">\(O(n)\)</span>，只需要模拟上述的过程即可．</p>
<p data-original-document-end="6101" data-original-document-start="5914">朴素计算 NFA 的时间复杂度为 <span class="arithmatex">\(O(ns^2)\)</span>，这是因为需要考虑到每一种后继，以及状态的合并所需的复杂度．当然，可以使用 bitset 或者 Method of Four Russians 将计算的复杂度优化到 <span class="arithmatex">\(O\left(\dfrac{ns^2}{w}\right)\)</span> 或 <span class="arithmatex">\(O\left(\dfrac{ns^2}{w\cdot \log n}\right)\)</span>．</p>
<h2 data-original-document-end="6116" data-original-document-start="6103" id="正则表达式与正则语言">正则表达式与正则语言<a class="headerlink" href="#正则表达式与正则语言" title="Permanent link"></a></h2>
<p data-original-document-end="6158" data-original-document-start="6118">本节将讨论正则表达式和正则语言的定义、性质，并研究正则表达式与 FSM 的关系．</p>
<h3 data-original-document-end="6169" data-original-document-start="6160" id="正则表达式">正则表达式<a class="headerlink" href="#正则表达式" title="Permanent link"></a></h3>
<p data-original-document-end="6272" data-original-document-start="6171"><strong>正则表达式</strong>（regular expression）是另一种常用的正则语言的描述方法．尽管我们可以在许多现代语言（例如 Python）中看到这个名字，但实际上这些语言实现的是正则表达式的一个超集．</p>
<details class="abstract" data-original-document-end="6557" data-original-document-start="6274" open="open">
<summary>正则表达式</summary>
<p>给定一个字符集 <span class="arithmatex">\(\Sigma\)</span>，正则表达式是由以下规则归纳定义的符号串：</p>
<ol>
<li>任意字符 <span class="arithmatex">\(c \in \Sigma\)</span> 是一个正则表达式；</li>
<li>空串符号 <span class="arithmatex">\(\varepsilon\)</span> 是正则表达式；</li>
<li>空语言符号 <span class="arithmatex">\(\varnothing\)</span> 是正则表达式；</li>
<li>如果 <span class="arithmatex">\(R_1\)</span> 和 <span class="arithmatex">\(R_2\)</span> 是正则表达式，那么 <span class="arithmatex">\((R_1 + R_2)\)</span>、<span class="arithmatex">\((R_1 R_2)\)</span>（也记作 <span class="arithmatex">\((R_1 \cdot R_2)\)</span>）、<span class="arithmatex">\((R_1^\ast)\)</span> 都是正则表达式．</li>
</ol>
</details>
<p data-original-document-end="6600" data-original-document-start="6559">正则表达式的目标是通过这些符号描述一个语言．每个正则表达式都有一个对应的形式语言．</p>
<details class="abstract" data-original-document-end="7197" data-original-document-start="6602" open="open">
<summary>正则表达式所表示的语言</summary>
<p>设每个正则表达式 <span class="arithmatex">\(R\)</span> 对应的形式语言为 <span class="arithmatex">\(L(R)\)</span>，则有：</p>
<ol>
<li>若 <span class="arithmatex">\(R = c\)</span>，其中 <span class="arithmatex">\(c \in \Sigma\)</span>，则 <span class="arithmatex">\(L(R) = \{c\}\)</span>；</li>
<li>若 <span class="arithmatex">\(R = \varepsilon\)</span>，则 <span class="arithmatex">\(L(R) = \{\varepsilon\}\)</span>；</li>
<li>若 <span class="arithmatex">\(R = \varnothing\)</span>，则 <span class="arithmatex">\(L(R) = \varnothing\)</span>；</li>
<li>若 <span class="arithmatex">\(R = (R_1 + R_2)\)</span>，则 <span class="arithmatex">\(L(R) = L(R_1) \cup L(R_2)\)</span>；</li>
<li>若 <span class="arithmatex">\(R = (R_1 R_2) = (R_1\cdot R_2)\)</span>，则 <span class="arithmatex">\(L(R) = \{ uv \mid u \in L(R_1),~ v \in L(R_2) \}\)</span>，其中，<span class="arithmatex">\(uv\)</span> 指将两个串前后拼接在一起；</li>
<li>若 <span class="arithmatex">\(R = (R_1^\ast)\)</span>，则 <span class="arithmatex">\(L(R) = \{u_1 u_2 \cdots u_n \mid u_i \in L(R_1),\ n \in \mathbf{N}_+\}\cup\{\varepsilon\}\)</span>，也称为 <strong>Kleene 星号</strong>（Kleene 星号）或 <strong>Kleene closure</strong>（Kleene 闭包），简称闭包．</li>
</ol>
</details>
<p data-original-document-end="7230" data-original-document-start="7199">当然，规定了运算的优先级后，这些小括号在不引起混淆时可以省略．</p>
<details class="example" data-original-document-end="7491" data-original-document-start="7232" open="open">
<summary>例子</summary>
<p>设 <span class="arithmatex">\(L(R_1) = \{0,\ 01\}\)</span>，<span class="arithmatex">\(L(R_2) = \{\varepsilon,\ 1,\ 11,\ 111,\ \dots\}\)</span>，则有：</p>
<ul>
<li><span class="arithmatex">\(L(R_1R_2) = \{0,\ 01,\ 011,\ 0111,\ \dots\}\)</span>，</li>
<li><span class="arithmatex">\(R_2^\ast = R_2\)</span>，</li>
<li><span class="arithmatex">\(L(R_1 + R_2) = \{0,\ 01,\ \varepsilon,\ 1,\ 11,\ 111,\ \dots\}\)</span>．</li>
</ul>
</details>
<p data-original-document-end="7742" data-original-document-start="7493">每个正则表达式都可以通过 <a href="https://zh.wikipedia.org/wiki/%E6%B1%A4%E6%99%AE%E6%A3%AE%E6%9E%84%E9%80%A0%E6%B3%95">Thompson 构造法</a>（Thompson's construction）转换为一个 NFA，每个 DFA 也都可以通过状态消除法<sup id="fnref:state-elimination-method"><a class="footnote-ref" href="#fn:state-elimination-method">2</a></sup>（State Elimination Method）转换为一个正则表达式．所以，正则表达式与 FSM 是等价的．</p>
<h3 data-original-document-end="7752" data-original-document-start="7744" id="正则语言">正则语言<a class="headerlink" href="#正则语言" title="Permanent link"></a></h3>
<p data-original-document-end="7827" data-original-document-start="7754">在本小节中，我们不考虑具体的正则表达式，转而考虑以变量为参数的正则表达式（变量可以为任意正则语言）．运用正则表达式的代数定律有助于化简正则表达式．</p>
<details class="note" data-original-document-end="8357" data-original-document-start="7829" open="open">
<summary>正则语言的代数性质</summary>
<ol>
<li>并的交换律：<span class="arithmatex">\(L + M = M + L\)</span></li>
<li>并的结合律：<span class="arithmatex">\((L + M) + N = L + (M + N)\)</span></li>
<li>连接的结合律：<span class="arithmatex">\((LM)N = L(MN)\)</span></li>
<li><span class="arithmatex">\(\varnothing\)</span> 是并运算的单位元：<span class="arithmatex">\(\varnothing + L = L + \varnothing = L\)</span></li>
<li><span class="arithmatex">\(\varepsilon\)</span> 是连接运算的单位元：<span class="arithmatex">\(\varepsilon L = L \varepsilon = L\)</span></li>
<li><span class="arithmatex">\(\varnothing\)</span> 是连接运算的零因子：<span class="arithmatex">\(\varnothing L = L \varnothing = \varnothing\)</span></li>
<li>分配律：<span class="arithmatex">\(L(M + N) = LM + LN\)</span>，<span class="arithmatex">\((M + N)L = ML + NL\)</span></li>
<li>并的幂等律：<span class="arithmatex">\(L + L = L\)</span></li>
<li>闭包相关的定律：<span class="arithmatex">\((L^\ast)^\ast = L^\ast\)</span>，<span class="arithmatex">\(\varnothing^\ast = \varepsilon\)</span>，<span class="arithmatex">\(\varepsilon^\ast = \varepsilon\)</span></li>
</ol>
</details>
<p data-original-document-end="8457" data-original-document-start="8359">正则语言的 <strong>封闭性</strong> 也是重要的性质．这些性质允许我们从一些简单的自动机出发，通过一定的运算，构造能够识别另一些语言的有限状态机（FSM）．简而言之，封闭性可以作为构造复杂 FSM 的工具．</p>
<p data-original-document-end="8474" data-original-document-start="8459">关于正则语言的封闭性，我们有：</p>
<details class="note" data-original-document-end="9037" data-original-document-start="8476" open="open">
<summary>正则语言的封闭性</summary>
<p>设 <span class="arithmatex">\(L,M\)</span> 为字符集 <span class="arithmatex">\(\Sigma\)</span> 上的两个正则语言，且映射 <span class="arithmatex">\(h:\Sigma\to\Sigma^*\)</span>．定义字符串 <span class="arithmatex">\(s=s_1s_2\cdots s_n\)</span> 的同态为 <span class="arithmatex">\(h(s)=h(s_1)h(s_2)\cdots h(s_n)\)</span>．那么，</p>
<ol>
<li>两个正则语言的并 <span class="arithmatex">\(L + M\)</span> 是正则的，</li>
<li>两个正则语言的连接 <span class="arithmatex">\(LM\)</span> 是正则的，</li>
<li>正则语言的闭包 <span class="arithmatex">\(L^*\)</span> 是正则的，</li>
<li>正则语言的补 <span class="arithmatex">\(\Sigma^*\setminus L\)</span> 是正则的，</li>
<li>两个正则语言的交 <span class="arithmatex">\(L\cap M\)</span> 是正则的，</li>
<li>两个正则语言的差 <span class="arithmatex">\(L\setminus M\)</span> 是正则的，</li>
<li>正则语言的反转 <span class="arithmatex">\(L^R=\{s_n\cdots s_2s_1 \mid s=s_1s_2\cdots s_n\in L\}\)</span> 是正则的，</li>
<li>正则语言的同态 <span class="arithmatex">\(h(L)=\{h(s)\mid s\in L\}\)</span> 是正则的，</li>
<li>正则语言的逆同态 <span class="arithmatex">\(h^{-1}(L) = \{ s \in \Sigma^\ast \mid h(s) \in L \}\)</span> 是正则的．</li>
</ol>
</details>
<p data-original-document-end="9109" data-original-document-start="9039">一个简单的推论是，所有的有限语言都是正则语言．实际上，<a href="../../string/trie/">字典树 Trie</a> 就是一个识别它们的自动机．</p>
<h2 data-original-document-end="9130" data-original-document-start="9111" id="myhillnerode-定理">Myhill–Nerode 定理<a class="headerlink" href="#myhillnerode-定理" title="Permanent link"></a></h2>
<p data-original-document-end="9192" data-original-document-start="9132">Myhill–Nerode 定理给出了一个语言是否是正则语言的判定标准．该定理通过等价类的概念描述了正则语言的结构特征．</p>
<details class="abstract" data-original-document-end="9357" data-original-document-start="9194" open="open">
<summary>Nerode 等价关系</summary>
<p>对于一个语言 <span class="arithmatex">\(L\)</span> 和任意串 <span class="arithmatex">\(x,y\in \Sigma^\ast\)</span>，如果对于任意 <span class="arithmatex">\(z\in\Sigma^*\)</span>，都有 <span class="arithmatex">\(xz\in L\iff yz\in L\)</span>，那么，称字符串 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 关于 <span class="arithmatex">\(L\)</span> 是等价的，记作 <span class="arithmatex">\(x\equiv_L y\)</span>．</p>
</details>
<p data-original-document-end="9469" data-original-document-start="9359">也就是说，如果对于两个串 <span class="arithmatex">\(x\)</span> 与 <span class="arithmatex">\(y\)</span>，在 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 后面拼上相同的任意串 <span class="arithmatex">\(z\)</span>（包括空串），它们总是要么同时属于 <span class="arithmatex">\(L\)</span> 或者同时不属于 <span class="arithmatex">\(L\)</span> 的，则我们说 <span class="arithmatex">\(x\)</span> 与 <span class="arithmatex">\(y\)</span> 关于 <span class="arithmatex">\(L\)</span> 等价．</p>
<p data-original-document-end="9620" data-original-document-start="9471">根据上述定义，我们把所有有限字符串的集合划分成一个或多个等价类．当且仅当这些等价类的数目只有有限多个时，可以利用这些等价类构造一个识别该语言的 DFA．这个 DFA 的状态数目就等于等价类的数目．而且，这个状态数目是所有能够识别该语言的 DFA 中最小的．这就是 Myhill–Nerode 定理．</p>
<details class="note" data-original-document-end="9876" data-original-document-start="9622" open="open">
<summary>Myhill–Nerode 定理</summary>
<p>一个语言 <span class="arithmatex">\(L\)</span> 是正则的，当且仅当 <span class="arithmatex">\(\Sigma^\ast\)</span> 通过等价关系 <span class="arithmatex">\(\equiv_L\)</span> 划分成的等价类数量是有限的．</p>
<p>对于任何能识别语言 <span class="arithmatex">\(L\)</span> 的 DFA，任意两个能驱使它走到同一个状态的串 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 必在同一个等价类中．</p>
<p>进而，等价类的数量就是可以识别 <span class="arithmatex">\(L\)</span> 的最小 DFA 的状态数量．每个等价类都恰好对应最小 DFA 里的一个状态．这个最小 DFA 在同构意义下是唯一的．</p>
</details>
<p data-original-document-end="9905" data-original-document-start="9878">这个定理提供了一种方法，能够利用等价关系构造 DFA：</p>
<ul data-original-document-end="10148" data-original-document-start="9907">
<li>状态集合，就是根据等价关系划分得到的所有等价类．每个等价类都随意选定一个代表字符串（例如某个串长最小的串）．</li>
<li>要构造转移函数，只需要将选定的代表字符串后面添加转移中的字符，并找到得到的字符串所在等价类对应的状态，就是相应的转移的后继状态．因为同一等价类中，所有字符串都是等价的，所以任意选定的代表字符串并不会影响转移的结果．</li>
<li>初始状态，就是空字符串 <span class="arithmatex">\(\varepsilon\)</span> 对应的等价类．</li>
<li>接受状态集合，就是代表字符串属于所给语言的等价类的集合．</li>
</ul>
<p data-original-document-end="10218" data-original-document-start="10150">作为一个经典的例子，<a href="../../string/sam/">后缀自动机</a> 就是利用 Myhill–Nerode 定理构造出的最小 DFA．</p>
<p data-original-document-end="10313" data-original-document-start="10220">Myhill–Nerode 定理通常应用于一些无限大的正则语言对应的 DFA 的构造．很多时候，问题的条件比较简单，只需要考察长度不太长的字符串的集合，就可以构造出识别整个语言的自动机．</p>
<h3 data-original-document-end="10321" data-original-document-start="10315" id="例题">例题<a class="headerlink" href="#例题" title="Permanent link"></a></h3>
<p data-original-document-end="10357" data-original-document-start="10323">本节通过一道例题介绍如何实际应用 Myhill–Nerode 定理．</p>
<details class="example" data-original-document-end="10769" data-original-document-start="10359" open="open">
<summary><a href="https://www.luogu.com.cn/problem/P12294">P12294 [THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1（加强版）</a></summary>
<p>关于 <span class="arithmatex">\(a,b,c\)</span> 的三目运算表 <span class="arithmatex">\(s_0s_1\cdots s_7\)</span>（<span class="arithmatex">\(s\)</span> 仅由 <span class="arithmatex">\(0,1\)</span> 组成）的含义是，如果 <span class="arithmatex">\(s\)</span> 的第 <span class="arithmatex">\(a+2b+4c\)</span> 位为 <span class="arithmatex">\(1\)</span>，那么返回 <span class="arithmatex">\(1\)</span>，否则返回 <span class="arithmatex">\(0\)</span>．</p>
<p>给定运算表 <span class="arithmatex">\(s\)</span> 以及 <span class="arithmatex">\(q\)</span> 个长为 <span class="arithmatex">\(2n+1\)</span> 的 <span class="arithmatex">\(01\)</span> 串，你需要对于对每个 <span class="arithmatex">\(01\)</span> 串分别回答：</p>
<p>能否操作 <span class="arithmatex">\(n\)</span> 次，每次将三位连续的数字替换为所对应的运算值，使得运算的结果为 <span class="arithmatex">\(1\)</span>，给出方案，或判断无解．</p>
<p><span class="arithmatex">\(1\le 2n+1\le 10^5,~\sum(2n+1)\le 3\times 10^5\)</span>．</p>
</details>
<details class="note" data-original-document-end="12058" data-original-document-start="10771">
<summary>题解</summary>
<p>能够合成出 <span class="arithmatex">\(1\)</span> 的 <span class="arithmatex">\(01\)</span> 串集合是一个正则语言（也就是存在一个 DFA 能够判定一个 <span class="arithmatex">\(01\)</span> 串能否合成出 <span class="arithmatex">\(1\)</span>）<sup id="fnref:prove-regular-language"><a class="footnote-ref" href="#fn:prove-regular-language">6</a></sup>．故考虑使用 Myhill–Nerode 定理．因为条件比较简单，经过实验，我们只需要对于长度 <span class="arithmatex">\(\le 9\)</span> 的 <span class="arithmatex">\(01\)</span> 串进行等价类划分；判定两个串等价时，只需要往后枚举长度 <span class="arithmatex">\(\le 6\)</span> 的后缀进行判定．只要两个串，接上长度 <span class="arithmatex">\(\le 6\)</span> 的任意后缀，它们要么能够同时合成出我们想要的串，要么两个都不能合成我们想要的串，那么这两个串就是等价的．</p>
<p>每次转移都相当于在当前串后面添加一个新的 <span class="arithmatex">\(01\)</span> 字符，然后将这个新串变为这个新串所在等价类中串长最小的串．根据上述转移设计一个自动机．该自动机能够在 <span class="arithmatex">\(O(n)\)</span> 复杂度内判定一个长度为 <span class="arithmatex">\(n\)</span> 的串是否存在一种运算方式使得结果为 <span class="arithmatex">\(1\)</span>．同时自动机的状态数非常少．</p>
<p>为了方便，我们会建 <span class="arithmatex">\(6\)</span> 个自动机，这 <span class="arithmatex">\(6\)</span> 个自动机分别表示能否通过一种运算方式使得结果为 <span class="arithmatex">\(0,1,00,01,10,11\)</span>．对于所有可能的运算表，自动机的最大状态数目为 <span class="arithmatex">\(47\)</span>．</p>
<p>利用自动机，通过适当的预处理，可以考虑使用倍增或者猫树实现静态区间查询区间是否存在一种运算方式使得结果为 <span class="arithmatex">\(1\)</span>，前者查询一次是 <span class="arithmatex">\(O(\log n)\)</span>，后者查询一次是 <span class="arithmatex">\(O(1)\)</span> 的．</p>
<p>考虑使用分治解决构造问题．设 <span class="arithmatex">\(f(l,r,t)\)</span> 表示区间 <span class="arithmatex">\([l,r]\)</span> 合并出 <span class="arithmatex">\(t\in\{{0,1,00,01,10,11}\}\)</span> 的方案．此时使用启发式分裂，维护两个指针 <span class="arithmatex">\(i,j\)</span> 一个从左到右扫，一个从右往左扫，以枚举断点 <span class="arithmatex">\(\textit{mid}\)</span> 为 <span class="arithmatex">\(i\)</span> 或 <span class="arithmatex">\(j\)</span>．对于 <span class="arithmatex">\(t\in\{{0,1}\}\)</span>，则枚举 <span class="arithmatex">\(t\)</span> 是怎么分为左右两个部分的，其中一个部分的 <span class="arithmatex">\(t\)</span> 长度为 <span class="arithmatex">\(2\)</span>，另一个部分 <span class="arithmatex">\(t\)</span> 长度为 <span class="arithmatex">\(1\)</span>．（例如对于中位数的运算表 <span class="arithmatex">\(s=00010111\)</span>，<span class="arithmatex">\(1\)</span> 可以分为 <span class="arithmatex">\(01\)</span> 和 <span class="arithmatex">\(1\)</span>．）对于 <span class="arithmatex">\(t\in\{{00,01,10,11}\}\)</span>，则 <span class="arithmatex">\(type\)</span> 直接分为左右两个部分．</p>
<p>如果此时分为的左右两个部分分别为 <span class="arithmatex">\(t_1\)</span> 与 <span class="arithmatex">\(t_2\)</span>，则进一步判断 <span class="arithmatex">\([l,mid]\)</span> 能否生成 <span class="arithmatex">\(t_1\)</span> 和 <span class="arithmatex">\([\textit{mid}+1,r]\)</span> 能否生成 <span class="arithmatex">\(t_2\)</span>，如果能则直接分治下去．如果使用 <span class="arithmatex">\(O(1)\)</span> 猫树判定，这么启发式分裂构造的复杂度是 <span class="arithmatex">\(O(n\log n)\)</span>；否则，利用倍增判定，构造的复杂度就是 <span class="arithmatex">\(O(n\log^2n)\)</span> 的．</p>
<p>如果使用了猫树，总复杂度是 <span class="arithmatex">\(O(n|Q|\log n+n\log n)\)</span>，其中，<span class="arithmatex">\(|Q|\le 47\)</span>．参考代码为了方便，使用了倍增，并且通过底层分块减小常数，对应的总复杂度为 <span class="arithmatex">\(O(n|Q|\log n+n\log^2 n)\)</span>．</p>
</details>
<details class="note" data-original-document-end="12141" data-original-document-start="12060">
<summary>参考代码</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;array&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unordered_map&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">L</span><span class="o">&gt;</span><span class="w"> </span><span class="n">op</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="c1">// Build a DFA that accepts binary strings which evaluate to a given string.</span>
<span class="c1">//   0b000 → &quot;00&quot;</span>
<span class="c1">//   0b001 → &quot;01&quot;</span>
<span class="c1">//   0b010 → &quot;10&quot;</span>
<span class="c1">//   0b011 → &quot;11&quot;</span>
<span class="c1">//   0b100 → &quot;0&quot;</span>
<span class="c1">//   0b101 → &quot;1&quot;</span>
<span class="n">DFA</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">L2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The result for string `st` of length `len` is stored at (1 &lt;&lt; len) | st.</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">st</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">st</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Compute which bit strings are accepted using dynamic programming.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">acc</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">L1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">  </span><span class="n">acc</span><span class="p">[(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">idx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">idx</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">L1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L2</span><span class="p">;</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">st</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Replace st[i..i+2] using the op[] rule, and check if the result is</span>
<span class="w">        </span><span class="c1">// accepted. Result = st[0..i-1] + op[st[i..i+2]] + st[i+3..end]</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pr</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">((((</span><span class="n">st</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">L</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">op</span><span class="p">[(</span><span class="n">st</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="w">            </span><span class="p">(</span><span class="n">st</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">acc</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pr</span><span class="p">)])</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">acc</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Construct a DFA using the Myhill-Nerode theorem.</span>
<span class="w">  </span><span class="n">DFA</span><span class="w"> </span><span class="n">dfa</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">mp</span><span class="p">;</span><span class="w">                </span><span class="c1">// Maps characteristic vectors to state IDs.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sts</span><span class="p">;</span><span class="w">  </span><span class="c1">// Representative 01 strings for each state.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ids</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">L1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">  </span><span class="c1">// Maps 01 strings to DFA state IDs.</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">L1</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">);</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">st</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Construct characteristic vector for this prefix.</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">L2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">nxt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">nxt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">L2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">nxt</span><span class="p">)</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">acc</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nxt</span><span class="p">),</span><span class="w"> </span><span class="n">acc</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">st</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nxt</span><span class="p">),</span>
<span class="w">                  </span><span class="n">key</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nxt</span><span class="p">));</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mp</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">mp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="n">sts</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">st</span><span class="p">);</span>
<span class="w">        </span><span class="n">dfa</span><span class="p">.</span><span class="n">acc</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)]);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">ids</span><span class="p">[</span><span class="n">st</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Build transitions.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ids</span><span class="p">[(</span><span class="n">sts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">dfa</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">DFA</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">;</span>

<span class="c1">// Initialize the DFA&#39;s.</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">op</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">op</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">X</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">build</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">  </span><span class="c1">// Block size is 2^B.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">pre</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">precompute</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">pre</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Compute transitions over single blocks (2^B characters) for each DFA.</span>
<span class="w">  </span><span class="n">pre</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">nn</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nn</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">X</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">pre</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">n</span><span class="p">);</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">);</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">ii</span><span class="p">)</span>
<span class="w">          </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">trans</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="p">]][</span><span class="n">cr</span><span class="p">];</span>
<span class="w">        </span><span class="n">pre</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cr</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Build higher-level transitions using binary lifting.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nn</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pre</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">d</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">X</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">pre</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">].</span><span class="n">resize</span><span class="p">(</span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">n</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">          </span><span class="n">pre</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
<span class="w">              </span><span class="n">pre</span><span class="p">[</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))][</span><span class="n">x</span><span class="p">][</span><span class="n">pre</span><span class="p">[</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">j</span><span class="p">]];</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Check if the x-th DFA accepts s[l...r].</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">q0</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">trans</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]][</span><span class="n">cr</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">trans</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]][</span><span class="n">cr</span><span class="p">];</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">pre</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">z</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">d</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pre</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">cr</span><span class="p">];</span>
<span class="w">        </span><span class="n">l</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">trans</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]][</span><span class="n">cr</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">dfa</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">acc</span><span class="p">[</span><span class="n">cr</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Construct expression for s[l...r].</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">calc</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="p">;</span>
<span class="w">          </span><span class="n">calc</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">          </span><span class="n">calc</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="p">;</span>
<span class="w">          </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;(&#39;</span><span class="p">;</span>
<span class="w">          </span><span class="n">calc</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">          </span><span class="n">calc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;)&#39;</span><span class="p">;</span>
<span class="w">          </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">calc</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="n">calc</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">calc</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="n">calc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">  </span><span class="n">precompute</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mb">0b101</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">calc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mb">0b101</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">init</span><span class="p">();</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">solve</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<h3 data-original-document-end="12149" data-original-document-start="12143" id="习题">习题<a class="headerlink" href="#习题" title="Permanent link"></a></h3>
<ul data-original-document-end="12308" data-original-document-start="12151">
<li><a href="https://qoj.ac/problem/12010">Median Replace Hard</a></li>
<li><a href="https://www.luogu.com.cn/problem/P10436">JOISC 2024 卡牌收集</a>（通过 Myhill–Nerode 定理建立自动机，本题可以做到多次区间查询）</li>
</ul>
<h2 data-original-document-end="12320" data-original-document-start="12310" id="dfa-最小化">DFA 最小化<a class="headerlink" href="#dfa-最小化" title="Permanent link"></a></h2>
<p data-original-document-end="12481" data-original-document-start="12322">前文提到，两个 DFA 等价当且仅当它们识别相同的正则语言．根据识别的语言不同，全体 DFA 划分为无穷多个等价类．在进行 DP 套 DP 之类的算法时，建立出来的 DFA 的 <span class="arithmatex">\(|Q|\)</span> 可能过大，使得外层 DP 转移复杂度过大．因此，往往需要找到 DFA 所属等价类中的最小 DFA，以减少外层 DP 转移复杂度．</p>
<p data-original-document-end="12662" data-original-document-start="12483">上一节的 Myhill–Nerode 定理就提供了一种构造方法．但是，对于一些比较复杂的问题，直接通过 Myhill–Nerode 定理构造需要遍历相当长的字符串的集合，花费大量时间．因此，我们需要一种方法，可以从已经构造出来的 DFA（通常较为容易）出发，直接构造一个最小 DFA．这就称为 <strong>DFA 最小化</strong>（DFA minimization）问题．</p>
<p data-original-document-end="12974" data-original-document-start="12664">DFA 最小化常用的算法是 <strong>Hopcroft 算法</strong>．由于 Myhill–Nerode 定理指出，对于任意一个可以识别某语言的 DFA，能够驱使它到达同一状态的字符串都必然是 Nerode 等价的．所有 Nerode 等价的字符串对应着最小 DFA 中的同一个状态，所以，最小 DFA 的状态一定是当前 DFA 中若干个状态的集合．我们可以从已有的 DFA 的状态集合出发，将它们划分为若干个等价类，而无需考察具体的字符串．Hopcroft 算法从最粗糙的划分 <span class="arithmatex">\(\{F,Q\setminus F\}\)</span> 开始，利用一系列证据 <span class="arithmatex">\(A\)</span>，改进这个划分，直到无法进一步改进为止．这就是 Hopcroft 算法的核心想法．</p>
<p data-original-document-end="13412" data-original-document-start="12976">所谓 <strong>证据</strong>  <span class="arithmatex">\(A\)</span>，就是一个状态集合，而且它和它的补集 <span class="arithmatex">\(Q\setminus A\)</span> 一定对应着不同的 Nerode 等价类．也就是说，存在某个字符串 <span class="arithmatex">\(s\in\Sigma^*\)</span>，使得分别从 <span class="arithmatex">\(A\)</span> 和 <span class="arithmatex">\(Q\setminus A\)</span> 中的状态出发，读入字符串 <span class="arithmatex">\(s\)</span> 后，<span class="arithmatex">\(A\)</span> 中的状态全部处于接受状态，而 <span class="arithmatex">\(Q\setminus A\)</span> 中的状态全部属于非接受状态，或者反过来．因此，如果有两个状态 <span class="arithmatex">\(u,v\in Q\)</span>，它们在某个字符 <span class="arithmatex">\(c\)</span> 下恰好一个转移到证据 <span class="arithmatex">\(A\)</span> 中，一个转移到证据 <span class="arithmatex">\(A\)</span> 外，即 <span class="arithmatex">\(\delta(u,c)\in A\)</span> 和 <span class="arithmatex">\(\delta(v,c)\in A\)</span> 成立且仅成立一个，那么，<span class="arithmatex">\(u,v\)</span> 同样不属于一个 Nerode 等价类——状态 <span class="arithmatex">\(\delta(u,cs)\)</span> 和 <span class="arithmatex">\(\delta(v,cs)\)</span> 中有且只有一个位于接受状态．因此，利用是否成立 <span class="arithmatex">\(\delta(u,c)\in A\)</span> 这一点，就可以改进划分．具体地，设</p>
<div class="arithmatex" data-original-document-end="13463" data-original-document-start="13414">\[
S_x = \{u\mid u\in P_x,~\delta(u,c)\in A\}.
\]</div>
<p data-original-document-end="13555" data-original-document-start="13465">如果 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span> 均不是空集，那么，当前的划分中状态集合 <span class="arithmatex">\(P_x\)</span> 就可以改进为 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span>．</p>
<p data-original-document-end="13901" data-original-document-start="13557">最开始时，将接受状态集合 <span class="arithmatex">\(F\)</span> 作为一个证据塞入证据集合 <span class="arithmatex">\(W\)</span>，即 <span class="arithmatex">\(W\gets\{F\}\)</span>，并维护当前的划分为 <span class="arithmatex">\(P\gets\{F,~Q\setminus F\}\)</span>．初始证据是显然成立的：<span class="arithmatex">\(F\)</span> 和 <span class="arithmatex">\(Q\setminus F\)</span> 中的状态绝不可能等价．每次都从证据集合 <span class="arithmatex">\(W\)</span> 中随意取出一个集合 <span class="arithmatex">\(A\)</span> 用于改进当前的划分．枚举所有的字符 <span class="arithmatex">\(c\in\Sigma\)</span>．对当前划分 <span class="arithmatex">\(P\)</span> 中的每个状态集合 <span class="arithmatex">\(P_x\)</span> 都求出前文描述的 <span class="arithmatex">\(S_x\)</span>．如果 <span class="arithmatex">\(S_x\neq\varnothing\)</span> 且 <span class="arithmatex">\(|S_x|\neq|P_x|\)</span>，就意味着 <span class="arithmatex">\(P_x\)</span> 可以进一步分为两个集合 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span>，直接用它们替换掉 <span class="arithmatex">\(P\)</span> 中的 <span class="arithmatex">\(P_x\)</span>．</p>
<p data-original-document-end="14439" data-original-document-start="13903">每当获得更细致的划分时，就意味着获得了新的证据．原则上，可以将新得到的 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span> 都塞进证据集合 <span class="arithmatex">\(W\)</span>，等待后续进一步验证．但是，这样做并不是必要的．容易理解，对于三个证据 <span class="arithmatex">\(P_x,S_x,P_x\setminus S_x\)</span>，只需要验证其中任意两个，就可以保证结果的正确性：因为结果只有 <span class="arithmatex">\(\delta(u,c)\in S_x\)</span>、<span class="arithmatex">\(\delta(u,c)\in P_x\setminus S_x\)</span> 和 <span class="arithmatex">\(\delta(u,c)\notin P_x\)</span> 三种，而将集合划分成三部分只需要两次判断．因此，将 <span class="arithmatex">\(P_x\)</span> 划分为 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span> 时，如果 <span class="arithmatex">\(P_x\)</span> 仍处于证据集合 <span class="arithmatex">\(W\)</span> 中，这说明还没有检验过证据 <span class="arithmatex">\(P_x\)</span>，就需要将证据集合 <span class="arithmatex">\(W\)</span> 中的 <span class="arithmatex">\(P_x\)</span> 替换为 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span> 两个；否则，当前的划分一定相当于<sup id="fnref:smaller-evidence"><a class="footnote-ref" href="#fn:smaller-evidence">3</a></sup>已经检验过 <span class="arithmatex">\(P_x\)</span> 的结果，所以，只需要将 <span class="arithmatex">\(S_x\)</span> 和 <span class="arithmatex">\(P_x\setminus S_x\)</span> 中较小的那个塞入证据集合 <span class="arithmatex">\(W\)</span> 中．类似于启发式分裂，这样做可以得到优秀的复杂度．</p>
<p data-original-document-end="14454" data-original-document-start="14441">将上述过程写成伪代码就是：</p>
<div class="arithmatex">\[
\begin{array}{l}
\textbf{Algorithm } \text{Hopcroft's Algorithm}(Q, \Sigma, \delta, q_0, F): \\
\textbf{Input. } \text{DFA } A=(Q, \Sigma, \delta, q_0, F). \\
\textbf{Output. } \text{A partition of } Q \text{ into equivalence classes of the minimal DFA.} \\
\textbf{Method. } \\
\begin{array}{ll}
1 &amp; P \gets \{F,\; Q \setminus F\} \\
2 &amp; W \gets \{F\} \\
3 &amp; \textbf{while } W \ne \varnothing \\
4 &amp; \quad \text{choose and remove any } A \in W \\
5 &amp; \quad \textbf{for each } c \in \Sigma \\
6 &amp; \quad \quad S \gets \{ q \in Q \mid \delta(q,c) \in A \} \\
7 &amp; \quad \quad \textbf{for each } Y \in P \text{ such that } S \cap Y \ne \varnothing \text{ and } Y \setminus S \ne \varnothing \\
8 &amp; \quad \quad \quad Y_1 \gets S \cap Y,~Y_2 \gets Y \setminus S \\
9 &amp; \quad \quad \quad P \gets (P \setminus \{Y\}) \cup \{Y_1, Y_2\} \\
10 &amp; \quad \quad \quad \textbf{if } Y \in W \\
11 &amp; \quad \quad \quad \quad W \gets (W \setminus \{Y\}) \cup \{Y_1, Y_2\} \\
12 &amp; \quad \quad \quad \textbf{else} \\
13 &amp; \quad \quad \quad \quad \text{add the smaller of } Y_1 \text{ and } Y_2 \text{ to } W \\
14 &amp; \textbf{return } P
\end{array}
\end{array}
\]</div>
<p data-original-document-end="16011" data-original-document-start="15600">算法实现时，复杂度的瓶颈在于 <span class="arithmatex">\(S\)</span> 的计算．直接遍历所有 <span class="arithmatex">\(q\in Q\)</span> 进而判断 <span class="arithmatex">\(\delta(q,c)\in A\)</span> 是否成立是不可行的．因此，需要在算法运行前，预处理反向转移边 <span class="arithmatex">\(\{q\in Q\mid \delta(q,c)=a\}\)</span>，从而，利用这些反向转移，遍历 <span class="arithmatex">\(a\in A\)</span>，就可以得到集合 <span class="arithmatex">\(S\)</span>．这样做可以保证每条转移 <span class="arithmatex">\(\delta(q,c)=a\)</span> 只会在 <span class="arithmatex">\(a\)</span> 属于某个证据时才会遍历到；而前文的证据筛选方法保证了，算法中实际用到的包含 <span class="arithmatex">\(a\)</span> 的证据序列 <span class="arithmatex">\(A_1\supset A_2\supset\cdots\supset A_k\)</span> 中，前一个至少是后一个的两倍大小，因此，<span class="arithmatex">\(k\in O(\log n)\)</span>．也就是说，每条转移边至多只会遍历 <span class="arithmatex">\(O(\log n)\)</span> 次，而总的转移数目是 <span class="arithmatex">\(n|\Sigma|\)</span> 的，因此，总的复杂度就是 <span class="arithmatex">\(O(n|\Sigma|\log n)\)</span> 的．</p>
<p data-original-document-end="16029" data-original-document-start="16013">参考实现如下：<sup id="fnref:detail"><a class="footnote-ref" href="#fn:detail">4</a></sup></p>
<details class="example" data-original-document-end="16117" data-original-document-start="16031">
<summary>参考实现</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// DFA minimization via Hopcroft&#39;s algorithm.</span>
<span class="c1">// Complexity: O(n * m * log(n)).</span>
<span class="n">DFA</span><span class="w"> </span><span class="nf">DFA::hopcroft_minimize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Construct inverse transition maps:</span>
<span class="w">  </span><span class="c1">// - pre[c] stores states sorted by the target of transition c.</span>
<span class="w">  </span><span class="c1">// - pos[c][s] is the start index in pre[c] of transitions going to state s.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">pre</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w"> </span><span class="n">pos</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pre</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Counting sort.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">++</span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="p">]];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">pre</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="o">--</span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="p">]]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Partition element structure:</span>
<span class="w">  </span><span class="c1">// - os: starting index in the state list.</span>
<span class="w">  </span><span class="c1">// - sz: number of states in this class.</span>
<span class="w">  </span><span class="c1">// - cnt: temporary count of marked states during refinement.</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">EquivClasses</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">os</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="p">;</span>

<span class="w">    </span><span class="n">EquivClasses</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">os</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">cnt</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">os</span><span class="p">(</span><span class="n">os</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">(</span><span class="n">sz</span><span class="p">),</span><span class="w"> </span><span class="n">cnt</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Partition and helper data structures.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">EquivClasses</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ec</span><span class="p">;</span><span class="w">  </span><span class="c1">// Current list of equivalence classes.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ids</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">       </span><span class="c1">// Permutation of states, grouped by ECs.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">par</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">       </span><span class="c1">// Maps state to its EC index.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tag</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">      </span><span class="c1">// Temporary marking for splitting.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">evidences</span><span class="p">;</span><span class="w">     </span><span class="c1">// Worklist of ECs to check.</span>

<span class="w">  </span><span class="c1">// Initial partition by acceptance label.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">iota</span><span class="p">(</span><span class="n">ids</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">ids</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">ids</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">ids</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">acc</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">acc</span><span class="p">[</span><span class="n">r</span><span class="p">];</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">acc</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">r</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">acc</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">l</span><span class="p">]];</span><span class="w"> </span><span class="o">++</span><span class="n">r</span><span class="p">)</span>
<span class="w">      </span><span class="n">par</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">r</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="n">evidences</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="w">  </span><span class="c1">// Add all but first class to worklist.</span>
<span class="w">    </span><span class="n">ec</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Refinement loop.</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">evidences</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evidences</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">    </span><span class="n">evidences</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">todo</span><span class="p">;</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">cr</span><span class="p">].</span><span class="n">os</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">cr</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">cr</span><span class="p">].</span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pos</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pre</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">tag</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ec</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="n">j</span><span class="p">]].</span><span class="n">cnt</span><span class="p">)</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">            </span><span class="o">++</span><span class="n">ec</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="n">j</span><span class="p">]].</span><span class="n">cnt</span><span class="p">;</span>
<span class="w">            </span><span class="n">tag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="c1">// Perform splits.</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">todo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cnt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Split into two: larger vs smaller segment.</span>
<span class="w">          </span><span class="kt">bool</span><span class="w"> </span><span class="n">majority_tagged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="p">;</span>
<span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span>
<span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">partition</span><span class="p">(</span><span class="n">ids</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="p">,</span>
<span class="w">                             </span><span class="n">ids</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="p">,</span>
<span class="w">                             </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">tag</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">majority_tagged</span><span class="p">;</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="o">-</span>
<span class="w">              </span><span class="n">ids</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="p">;</span>

<span class="w">          </span><span class="c1">// Assign new EC index to the smaller segment.</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mid</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="n">par</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">          </span><span class="n">evidences</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">majority_tagged</span><span class="p">)</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">          </span><span class="n">ec</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mid</span><span class="p">,</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mid</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">          </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mid</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// Clear temporary counters and tags.</span>
<span class="w">        </span><span class="n">ec</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">ti</span><span class="p">].</span><span class="n">os</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">ti</span><span class="p">].</span><span class="n">os</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ec</span><span class="p">[</span><span class="n">ti</span><span class="p">].</span><span class="n">sz</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">          </span><span class="n">tag</span><span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Build minimized DFA.</span>
<span class="w">  </span><span class="n">DFA</span><span class="w"> </span><span class="n">res</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">ec</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">q0</span><span class="p">]);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">ec</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ids</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">os</span><span class="p">];</span><span class="w">  </span><span class="c1">// Representative state.</span>
<span class="w">    </span><span class="n">res</span><span class="p">.</span><span class="n">acc</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acc</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par</span><span class="p">[</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">i</span><span class="p">]];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<p data-original-document-end="16298" data-original-document-start="16119">这一参考实现允许自动机的状态带有任何整数取值的标签，而并非简单的「接受」与「不接受」的二元标签．从参考实现可以看出，与基础 Hopcroft 算法的唯一不同就在于初始划分和证据集合的构造．这种拓展的自动机也称为 <a href="https://en.wikipedia.org/wiki/Moore_machine">Moore 机</a>．它的一个应用可以看本节的第二个例题．</p>
<h3 id="例题_1">例题<a class="headerlink" href="#例题_1" title="Permanent link"></a></h3>
<p data-original-document-end="16336" data-original-document-start="16308">本节通过两道例题介绍如何实际应用 DFA 最小化的技巧．</p>
<details class="example" data-original-document-end="16796" data-original-document-start="16338" open="open">
<summary>例题</summary>
<p>给定一个长度为 <span class="arithmatex">\(n\)</span> 的 <span class="arithmatex">\(01?\)</span> 串 <span class="arithmatex">\(a\)</span>，初始变量 <span class="arithmatex">\(x = 0\)</span>，我们按顺序遍历每一位 <span class="arithmatex">\(a_i\)</span> 并执行如下操作：</p>
<ol>
<li>若 <span class="arithmatex">\(a_i = 0\)</span>，令 <span class="arithmatex">\(x \gets x - \text{lowbit}(x)\)</span>；</li>
<li>若 <span class="arithmatex">\(a_i = 1\)</span>，令 <span class="arithmatex">\(x \gets x + \text{lowbit}(2^k - 1 - x)\)</span>；</li>
<li>若 <span class="arithmatex">\(a_i = ?\)</span>，可任选 <span class="arithmatex">\(0\)</span> 或 <span class="arithmatex">\(1\)</span>，对应上述两种操作之一．</li>
</ol>
<p>最终若 <span class="arithmatex">\(x \in [0, r]\)</span>，则称该操作序列是好的．</p>
<p>现在需要对每个 <span class="arithmatex">\(j = 1 \ldots n\)</span>，求在强制 <span class="arithmatex">\(a_j = 0\)</span> 的前提下，有多少「好的」完整序列．特别地，<span class="arithmatex">\(a_j = 1\)</span> 时，答案为 <span class="arithmatex">\(0\)</span>．</p>
<p><span class="arithmatex">\(1\le n\le 10^5,~1\le k\le 20,~0\le r&lt;2^k\)</span>．输出对 <span class="arithmatex">\(998244353\)</span> 取模．</p>
</details>
<details class="note" data-original-document-end="17073" data-original-document-start="17027">
<summary>题解</summary>
<p>考虑朴素 DP．设 <span class="arithmatex">\(f_{i,j}\)</span> 表示从 <span class="arithmatex">\(x=0\)</span> 开始，经过 <span class="arithmatex">\([1,i]\)</span> 的操作，当前数为 <span class="arithmatex">\(j\)</span> 的方案数．设 <span class="arithmatex">\(g_{i,j}\)</span> 表示从 <span class="arithmatex">\(x=j\)</span> 开始，经过 <span class="arithmatex">\([i,n]\)</span> 的操作，最终 <span class="arithmatex">\(x \in [0, r]\)</span> 的方案数．强制 <span class="arithmatex">\(a_i=0\)</span> 的答案，就是 <span class="arithmatex">\(\sum_j f_{i-1,j}g_{i+1,j - \text{lowbit}(j)}\)</span>．复杂度是 <span class="arithmatex">\(O(n2^k)\)</span>．</p>
<p>考虑直接将 <span class="arithmatex">\(j\)</span> 的转移建成 DFA，然后跑 DFA 最小化，再 DP 就可以了．</p>
</details>
<details class="note">
<summary>参考代码</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">998244353</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Initialize the DFA.</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">lowbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="w">  </span><span class="n">DFA</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lowbit</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lowbit</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">acc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// DFA minimization.</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">dfa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">hopcroft_minimize</span><span class="p">();</span>
<span class="w">  </span><span class="c1">// DP.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">  </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">dfa</span><span class="p">.</span><span class="n">q0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="o">%=</span><span class="w"> </span><span class="n">M</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">acc</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span><span class="w"> </span><span class="o">%=</span><span class="w"> </span><span class="n">M</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">][</span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span><span class="w"> </span><span class="o">%=</span><span class="w"> </span><span class="n">M</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="example" data-original-document-end="17463" data-original-document-start="17158" open="open">
<summary><a href="https://codeforces.com/contest/956/problem/F">Minimal Subset Difference</a></summary>
<p>定义 <span class="arithmatex">\(f(n)\)</span> 表示将十进制数 <span class="arithmatex">\(n\)</span> 所有数码之间填入加号或者减号，最终得到的值的绝对值最小值．</p>
<p><span class="arithmatex">\(T\)</span> 组询问．每组询问给定 <span class="arithmatex">\(l, r, k\)</span>，求满足 <span class="arithmatex">\(l \le m \le r\)</span> 且 <span class="arithmatex">\(f(m) \le k\)</span> 的 <span class="arithmatex">\(m\)</span> 的个数．</p>
<p><span class="arithmatex">\(1 \le T \le 5\times 10^4\)</span>，<span class="arithmatex">\(1 \le l \le r \le 10^{18}\)</span>，<span class="arithmatex">\(0 \le k \le 9\)</span>．</p>
</details>
<details class="note" data-original-document-end="18454" data-original-document-start="17645">
<summary>题解</summary>
<p>先给出一种贪心地计算 <span class="arithmatex">\(f(n)\)</span> 的方法．从高位向低位考虑一个数，最开始，设得到的数的和是 <span class="arithmatex">\(0\)</span>．计算到某一数位，如果当前合成出的数如果是负数就加上当前数位，如果是正数就减去当前数位．这么处理，贪心计算出的 <span class="arithmatex">\(f(n)\)</span> 的绝对值一定小于等于 <span class="arithmatex">\(9\)</span>．所以真实的 <span class="arithmatex">\(f(n)\)</span> 的绝对值一定小于等于 <span class="arithmatex">\(9\)</span>．</p>
<p>我们进一步思考，要合成出最终的答案，中间过程中能够合成出来的数最大能是多少．因为答案一定是小于等于 <span class="arithmatex">\(9\)</span> 的，而且数位只有 <span class="arithmatex">\(18\)</span> 位，每次最多只能加减 <span class="arithmatex">\(9\)</span>．过程中能够合成出来的数肯定是小于等于 <span class="arithmatex">\(90\)</span> 的，否则最后减不回来．实际上，这个上限还能够更低<sup id="fnref:upper-bound"><a class="footnote-ref" href="#fn:upper-bound">7</a></sup>．</p>
<p>考虑朴素 DP 套 DP．首先，思考内层 DP 怎么判定一个数的答案：定义 <span class="arithmatex">\(g_{i,c}\)</span> 表示这个数只根据前 <span class="arithmatex">\(i\)</span> 位，能否合成出 <span class="arithmatex">\(c\)</span>．根据前文，<span class="arithmatex">\(c\)</span> 只用保留小于等于 <span class="arithmatex">\(90\)</span> 的数．如果当前这一位填的是 <span class="arithmatex">\(v\)</span>，那么，有转移：</p>
<div class="arithmatex">\[
g_{i+1,c+v}\gets g_{i,c},~
g_{i+1,|c-v|}\gets g_{i,c}.
\]</div>
<p>外层 DP 考虑数位 DP．将询问差分．设状态为 <span class="arithmatex">\(f_{\textit{len},\textit{lim},\textit{sta}}\)</span>，它的下标分别表示已经考虑到第 <span class="arithmatex">\(\textit{len}\)</span> 位，是否有上界限制，当前自动机的状态位于 <span class="arithmatex">\(\textit{sta}\)</span> 等．</p>
<p>与普通的 DFA 不同，我们需要对自动机的每个状态记录对应的答案．跑一次暴力搜索，会发现内层 DP 的状态数只有 <span class="arithmatex">\(19564\)</span>．然后接下来直接跑 DFA 最小化，可以将状态数优化到 <span class="arithmatex">\(715\)</span>．</p>
<p>此时我们将 <span class="arithmatex">\(\textit{lim}=0\)</span> 的数位 DP 答案都预处理出来，在多测时就只需要跑 <span class="arithmatex">\(\textit{lim}=1\)</span> 的情况，可以很快地求出答案．</p>
<p>时间复杂度 <span class="arithmatex">\(O(|S||\Sigma|\log |S|+(|Q||\Sigma|+T)|\Sigma|\log_{10} V)\)</span>（<span class="arithmatex">\(|S|=19564\)</span>，<span class="arithmatex">\(|Q|=715\)</span>）．</p>
</details>
<details class="note">
<summary>参考代码</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bitset&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cmath&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unordered_map&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">91</span><span class="p">;</span>

<span class="k">using</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bitset</span><span class="o">&lt;</span><span class="n">L</span><span class="o">&gt;</span><span class="p">;</span>
<span class="n">DFA</span><span class="w"> </span><span class="nf">raw_dfa</span><span class="p">(</span><span class="n">B</span><span class="p">),</span><span class="w"> </span><span class="n">dfa</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ids</span><span class="p">;</span>

<span class="c1">// Construct a DFA by DFS.</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">dfs</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">state</span><span class="o">&amp;</span><span class="w"> </span><span class="n">cr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ids</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">cr</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">ids</span><span class="p">[</span><span class="n">cr</span><span class="p">];</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ids</span><span class="p">[</span><span class="n">cr</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">n</span><span class="o">++</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Check if accepted.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">acc</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// Construct transitions recursively.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="n">nt</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="n">nt</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">nt</span><span class="p">[</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfs</span><span class="p">(</span><span class="n">nt</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// DP.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">memo</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nums</span><span class="p">;</span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">sol</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">lim</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">dfa</span><span class="p">.</span><span class="n">acc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">(</span><span class="n">lim</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">nums</span><span class="p">[</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span>
<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sol</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lim</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nums</span><span class="p">[</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">lim</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">memo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">calc</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">nums</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="n">nums</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">sol</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">q0</span><span class="p">,</span><span class="w"> </span><span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Construct a DFA.</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">B</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">trans</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="n">reserve</span><span class="p">(</span><span class="mi">20000</span><span class="p">);</span>
<span class="w">  </span><span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// DFA minimization.</span>
<span class="w">  </span><span class="n">dfa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_dfa</span><span class="p">.</span><span class="n">hopcroft_minimize</span><span class="p">();</span>
<span class="w">  </span><span class="n">memo</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dfa</span><span class="p">.</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Queries.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">calc</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">calc</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="习题_1">习题<a class="headerlink" href="#习题_1" title="Permanent link"></a></h3>
<ul data-original-document-end="18651" data-original-document-start="18547">
<li><a href="http://poj.org/problem?id=3576">Language Recognition</a></li>
<li><a href="https://qoj.ac/problem/7083">Equanimous</a></li>
</ul>
<h2 data-original-document-end="18663" data-original-document-start="18653" id="自动机常见应用">自动机常见应用<a class="headerlink" href="#自动机常见应用" title="Permanent link"></a></h2>
<p data-original-document-end="18696" data-original-document-start="18665">本节列举了一些算法竞赛中常见的自动机的应用<sup id="fnref:is-dfa"><a class="footnote-ref" href="#fn:is-dfa">5</a></sup>．</p>
<h3 data-original-document-end="18705" data-original-document-start="18698" id="字典树">字典树<a class="headerlink" href="#字典树" title="Permanent link"></a></h3>
<p data-original-document-end="18817" data-original-document-start="18707"><a href="../../string/trie/">字典树</a> 是大部分 OIer 接触到的第一个自动机，接受且仅接受指定的字符串集合中的元素．转移函数就是 Trie 上的边，接受状态是将每个字符串插入到 Trie 时到达的那个状态．</p>
<h3 data-original-document-end="18830" data-original-document-start="18819" id="kmp-自动机">KMP 自动机<a class="headerlink" href="#kmp-自动机" title="Permanent link"></a></h3>
<p data-original-document-end="18919" data-original-document-start="18832"><a href="../../string/kmp/">KMP 算法</a> 可以视作自动机，基于字符串 <span class="arithmatex">\(s\)</span> 的 KMP 自动机接受且仅接受以 <span class="arithmatex">\(s\)</span> 为后缀的字符串，其接受状态为 <span class="arithmatex">\(|s|\)</span>．</p>
<p data-original-document-end="18926" data-original-document-start="18921">转移函数：</p>
<div class="arithmatex">\[
\delta(i, c)=
\begin{cases}
i+1&amp;s[i+1]=c\\
0&amp;s[1]\ne c\land i=0\\
\delta(\pi(i),c)&amp;s[i+1]\ne c\land i&gt;0
\end{cases}
\]</div>
<h3 data-original-document-end="19061" data-original-document-start="19051" id="ac-自动机">AC 自动机<a class="headerlink" href="#ac-自动机" title="Permanent link"></a></h3>
<p data-original-document-end="19143" data-original-document-start="19063"><a href="../../string/ac-automaton/">AC 自动机</a> 接受且仅接受以指定的字符串集合中的某个元素为后缀的字符串．也就是 Trie + KMP．</p>
<h3 data-original-document-end="19154" data-original-document-start="19145" id="后缀自动机">后缀自动机<a class="headerlink" href="#后缀自动机" title="Permanent link"></a></h3>
<p data-original-document-end="19197" data-original-document-start="19156"><a href="../../string/sam/">后缀自动机</a> 接受且仅接受指定字符串的后缀．</p>
<h3 data-original-document-end="19210" data-original-document-start="19199" id="广义后缀自动机">广义后缀自动机<a class="headerlink" href="#广义后缀自动机" title="Permanent link"></a></h3>
<p data-original-document-end="19287" data-original-document-start="19212"><a href="../../string/general-sam/">广义后缀自动机</a> 接受且仅接受指定的字符串集合中的某个元素的后缀．也就是 Trie + SAM．</p>
<p data-original-document-end="19327" data-original-document-start="19289">广义 SAM 与 SAM 的关系就是 AC 自动机与 KMP 自动机的关系．</p>
<h3 data-original-document-end="19338" data-original-document-start="19329" id="回文自动机">回文自动机<a class="headerlink" href="#回文自动机" title="Permanent link"></a></h3>
<p data-original-document-end="19386" data-original-document-start="19340"><a href="../../string/pam/">回文自动机</a> 比较特殊，它不能非常方便地定义为自动机．</p>
<p data-original-document-end="19430" data-original-document-start="19388">如果需要定义的话，它接受且仅接受某个字符串的所有回文子串的 <strong>中心及右半部分</strong>．</p>
<p data-original-document-end="19514" data-original-document-start="19432">「中心及右边部分」在奇回文串中就是字面意思，在偶回文串中定义为一个特殊字符加上右边部分．这个定义看起来很奇怪，但它能让 PAM 真正成为一个自动机，而不仅是两棵树．</p>
<h3 data-original-document-end="19525" data-original-document-start="19516" id="序列自动机">序列自动机<a class="headerlink" href="#序列自动机" title="Permanent link"></a></h3>
<p data-original-document-end="19579" data-original-document-start="19527"><a href="../../string/seq-automaton/">序列自动机</a> 接受且仅接受指定字符串的子序列．</p>
<h3 data-original-document-end="19592" data-original-document-start="19581" id="dp-套-dp">DP 套 DP<a class="headerlink" href="#dp-套-dp" title="Permanent link"></a></h3>
<p data-original-document-end="19682" data-original-document-start="19594"><a href="../../dp/dp-of-dp/">DP 套 DP</a> 是自动机的一个应用，可以看作是先通过内层 DP 建出自动机，再在外层通过自动机上的 DP 实现计数、最优化任务的技巧．</p>
<h2 data-original-document-end="19691" data-original-document-start="19684" id="后缀链接">后缀链接<a class="headerlink" href="#后缀链接" title="Permanent link"></a></h2>
<p data-original-document-end="19782" data-original-document-start="19693">由于自动机和匹配有着密不可分的关系，而匹配的一个基本思想是「这个串不行，就试试它的后缀可不可以」，所以在很多自动机（KMP、AC 自动机、SAM、PAM）中，都有后缀链接的概念．</p>
<p data-original-document-end="19887" data-original-document-start="19784">一个状态会对应若干字符串．它的后缀链接，就指向自动机上该状态对应的字符串的公共真后缀中，最长的那个对应的状态．一般地，后缀链接会形成一棵树，并且不同自动机的后缀链接树有着一些相同的性质，学习时可以加以注意．</p>
<h2 data-original-document-end="19896" data-original-document-start="19889" id="拓展阅读">拓展阅读<a class="headerlink" href="#拓展阅读" title="Permanent link"></a></h2>
<ul data-original-document-end="22251" data-original-document-start="19898">
<li><a href="https://lingeros-tot.github.io/2019/03/05/Warming-Up-自动机模型/">计算复杂性（1）Warming Up: 自动机模型</a></li>
<li><a href="https://github.com/OIerTFX/IOI/blob/master/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F2021%E8%AE%BA%E6%96%87%E9%9B%86/pdf-files/%E5%BE%90%E5%93%B2%E5%AE%89%20%E6%B5%85%E8%B0%88%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8.pdf">国家集训队 2021 论文 徐哲安 浅谈有限状态自动机及其应用</a></li>
<li><a href="https://en.wikipedia.org/wiki/Myhill%E2%80%93Nerode_theorem">Myhill–Nerode theorem - Wikipedia</a></li>
<li>Knuutila, Timo. "Re-describing an algorithm by Hopcroft." Theoretical Computer Science 250, no. 1-2 (2001): 333-363.</li>
<li>Hopcroft, John E., Rajeev Motwani, and Jeffrey D. Ullman. "Introduction to automata theory, languages, and computation." Acm Sigact News 32, no. 1 (2001): 60-65.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:nfa-and-nfaepsilon">
<p>这个定义中我们允许状态之间通过空字符（<span class="arithmatex">\(\varepsilon\)</span>）转移，因此更准确地说，这是一个带 <span class="arithmatex">\(\varepsilon\)</span> 转移的非确定有限自动机（NFA-<span class="arithmatex">\(\varepsilon\)</span>）．有些教材中将它直接称为 NFA，为简洁起见，本文采用这一用法．在理论上 NFA 与 NFA-<span class="arithmatex">\(\varepsilon\)</span> 是有所区分的，但是实际上它们的计算能力是一致的．&#160;<a class="footnote-backref" href="#fnref:nfa-and-nfaepsilon" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:state-elimination-method">
<p>详见 <a href="https://github.com/OIerTFX/IOI/blob/master/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F2021%E8%AE%BA%E6%96%87%E9%9B%86/pdf-files/%E5%BE%90%E5%93%B2%E5%AE%89%20%E6%B5%85%E8%B0%88%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8.pdf">国家集训队 2021 论文 徐哲安 浅谈有限状态自动机及其应用</a> 中 3.2 节．&#160;<a class="footnote-backref" href="#fnref:state-elimination-method" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:smaller-evidence">
<p>此处的「相当于」指的是，尽管实际上 <span class="arithmatex">\(P_x\)</span> 可能并没有实际检验过，但是，即使对当前划分进行 <span class="arithmatex">\(P_x\)</span> 的检验，也不会有任何改进．简单理解，就是在集合分裂得到的证据集合的树上，它的某个祖先和路径上的所有旁支都已经得到了检验，因此，可以归纳地说明，就相当于它也已经检验过了．&#160;<a class="footnote-backref" href="#fnref:smaller-evidence" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:detail">
<p>算法实现中有一处细节：对于一个证据 <span class="arithmatex">\(A\)</span>，有可能检验完一部分字符后，这个证据集合就已经分裂为 <span class="arithmatex">\(B\)</span> 和 <span class="arithmatex">\(C\)</span> 了．不妨设 <span class="arithmatex">\(|B|\ge |C|\)</span>．由于参考实现中，较小的集合 <span class="arithmatex">\(C\)</span> 插入到了证据队列的末尾，而较大的证据集合 <span class="arithmatex">\(B\)</span> 替换到了集合 <span class="arithmatex">\(A\)</span> 原来的位置．算法继续运行时，实际只是利用证据 <span class="arithmatex">\(B\)</span> 检验剩余的字符．这样做是正确的．这是因为对于已经检验完的字符，至少验证了 <span class="arithmatex">\(A\)</span> 和 <span class="arithmatex">\(C\)</span> 两个集合；而对于尚未检验的字符，至少验证了 <span class="arithmatex">\(B\)</span> 和 <span class="arithmatex">\(C\)</span> 两个集合．&#160;<a class="footnote-backref" href="#fnref:detail" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:is-dfa">
<p>本文对自动机的定义要求它是完备的，即任一状态在任一字符下都必须有转移．对这些字符串相关的自动机的描述中，通常会忽略失配状态．Trie、SAM 等都是这样的例子．为了与本文提供的定义相适应，需要在这些自动机的描述中显式地添加失配状态．&#160;<a class="footnote-backref" href="#fnref:is-dfa" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:prove-regular-language">
<p>详见 <a href="https://qoj.ac/download.php?type=attachments&amp;id=2079&amp;r=1">官方题解</a>．&#160;<a class="footnote-backref" href="#fnref:prove-regular-language" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:upper-bound">
<p>详见 <a href="https://github.com/OIerTFX/IOI/blob/master/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F2021%E8%AE%BA%E6%96%87%E9%9B%86/pdf-files/%E5%BE%90%E5%93%B2%E5%AE%89%20%E6%B5%85%E8%B0%88%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8.pdf">国家集训队 2021 论文 徐哲安 浅谈有限状态自动机及其应用</a> 中的例题 5.2．&#160;<a class="footnote-backref" href="#fnref:upper-bound" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  



 
 
   
<hr><blockquote class="page-copyright">
  <span><i class="md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"/></svg></i>本页面最近更新：</span><span class="facts_modified"></span>，<a class="edit_history">更新历史</a><br>
  <span><i class="md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg></i>发现错误？想一起完善？ <a href="https://oi-wiki.org/edit-landing/?ref=/misc/fsm.md" title="edit.link.title" class="page_edit_url">在 GitHub 上编辑此页！</a></span><br>
  <span><i class="md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 1 0 9 11a3.5 3.5 0 0 0 3.5-3.5m3.44 5.5A5.32 5.32 0 0 1 18 17v2h4v-2s0-3.63-6.06-4M15 4a3.4 3.4 0 0 0-1.93.59 5 5 0 0 1 0 5.82A3.4 3.4 0 0 0 15 11a3.5 3.5 0 0 0 0-7"/></svg></i>本页面贡献者：</span><span class="page_contributors">CCXXXI, countercurrent-time, Enter-tainer, FFjet, H-J-Granger, Ir1d, mgt, NachtgeistW, orzAtalod, ouuan, SukkaW</span><br>
  <span><i class="md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.4 1.4 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8"/></svg></i>本页面的全部内容在 <strong><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span>
</blockquote>


<div id="__comments" class="giscus" data-no-instant></div>
<div id="__comments_script"></div>
<script>var comments=document.createElement("script"),commentsTheme="slate"===document.body.dataset.mdColorScheme?"dark":"light";Object.entries({async:!0,src:"https://giscus.app/client.js",crossOrigin:"anonymous","data-repo":"OI-wiki/gitment","data-repo-id":"MDEwOlJlcG9zaXRvcnkxNDQzODg5NjU=","data-category":"评论","data-category-id":"DIC_kwDOCJszZc4CS54y","data-mapping":"specific","data-term":"有限状态自动机","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":commentsTheme,"data-lang":"zh-CN","data-loading":"lazy"}).forEach((e=>comments.setAttribute(e[0],e[1]))),document.getElementById("__comments_script").replaceWith(comments)</script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <script>function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script>
<button onclick="topFunction()" id="myBtn" class="data-tip-left" data-tip="回到顶部">
  <svg class="Zi Zi--BackToTop data-tip-left" data-tip="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24">
    <path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path>
  </svg>
</button>  
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2026 OI Wiki Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
      <div id="miitbeian"></div>
    </a>
  
</div>

<div style="float:right" class="build_date_utc">
  <a href="https://github.com/OI-wiki/OI-wiki">
    最近更新：, 2026-02-06
  </a>
</div>
<script>"oi-wiki.com"!=window.location.hostname&&"www.oi-wiki.com"!=window.location.hostname||(document.getElementById("miitbeian").innerHTML='<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>'),console.log("%c OI Wiki %c  %c","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),console.log("少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org")</script>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../../assets/javascripts/workers/search.931a43a5.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.73202423.min.js"></script>
      
        <script src="../../_static/js/math-csr.js?math-csr"></script>
      
        <script src="../../assets/vendor/mathjax/tex-mml-chtml.js?math-csr"></script>
      
        <script src="../../{OIWikiFeedbackSystemFrontendJS}"></script>
      
        <script src="../../{OIWikiFeedbackSystemFrontendContentScript}"></script>
      
      <script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then((function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)})).catch((function(e){console.log("PWA Registration failed with "+e)}))</script>
    
  </body>
</html>